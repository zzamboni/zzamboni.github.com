%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: main.dvi
%%Pages: 16
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Roman Courier Times-Bold Times-Italic
%%+ Courier-Bold
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips -s main.dvi -o main.ps
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2001.02.12:1329
/SafetyEnclosure save def
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "1 July 1998",
%   filename = "8r.enc",
%   email = "tex-fonts@@tug.org",
%   docstring = "Encoding for TrueType or Type 1 fonts
%                to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both 
% ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type/integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics/Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{
dup sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1
roll mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def
dup[exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}
if}forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}
def end

%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/copypage{}N/p 3 def @MacSetUp}N/doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N/endTexFig{end psf$SavedState restore}N/@beginspecial{SDict
begin/SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count/ocount X/dcount countdictstack N}N/@setspecial{
CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if/showpage{}N/erasepage{}N/copypage{}N newpath}N
/@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{end}
repeat grestore SpecialSave restore end}N/@defspecial{SDict begin}N
/@fedspecial{end}B/li{lineto}B/rl{rlineto}B/rc{rcurveto}B/np{/SaveX
currentpoint/SaveY X N 1 setlinecap newpath}N/st{stroke SaveX SaveY
moveto}N/fil{fill SaveX SaveY moveto}N/ellipse{/endangle X/startangle X
/yrad X/xrad X/savematrix matrix currentmatrix N TR xrad yrad scale 0 0
1 startangle endangle arc savematrix setmatrix}N end

%%EndProcSet
TeXDict begin @defspecial

 userdict begin /draftcopy-CurrentPage 0 def /bop-hook{ /draftcopy-CurrentPage
draftcopy-CurrentPage 1 add def draftcopy-CurrentPage 0 le { gsave
200 70 translate 65 rotate /Times-Roman findfont 215 scalefont setfont
0 0 moveto 0.85 setgray (DRAFT) show grestore } if } def end
 
@fedspecial end TeXDict begin
40258431 52099146 1000 600 600 (main.dvi) @start /Fa
134[55 1[55 55 55 55 55 55 55 55 55 55 55 55 55 1[55
55 55 55 55 55 55 55 55 1[55 6[55 55 1[55 55 55 55 55
55 55 55 55 55 55 1[55 55 55 55 55 55 55 55 55 2[55 55
1[55 1[55 5[55 1[55 55 55 55 55 55 1[55 55 55 55 55 2[55
55 55 33[{TeXBase1Encoding ReEncodeFont}65 90.9091 /Courier-Bold
rf
%DVIPSBitmapFont: Fb cmsy10 10.95 3
/Fb 3 111 df<153FEC03FFEC0FE0EC3F80EC7E00495A5C495AA2495AB3AA130F5C131F
495A91C7FC13FEEA03F8EA7FE048C8FCEA7FE0EA03F8EA00FE133F806D7E130F801307B3
AA6D7EA26D7E80EB007EEC3F80EC0FE0EC03FFEC003F205B7AC32D>102
D<12FCEAFFC0EA07F0EA01FCEA007E6D7E131F6D7EA26D7EB3AA801303806D7E1300147F
EC1FC0EC07FEEC00FFEC07FEEC1FC0EC7F0014FC1301495A5C13075CB3AA495AA2495A13
3F017EC7FC485AEA07F0EAFFC000FCC8FC205B7AC32D>I<126012F07EA21278127CA212
3C123EA2121E121FA27E7FA212077FA212037FA212017FA212007FA21378137CA27FA213
1E131FA27F80A2130780A2130380A2130180A2130080A21478147CA2143C143EA2141E14
1FA26E7EA2140781A2140381A2140181A2140081A21578157CA2153C153EA2151E151FA2
811680A2150716C0A21503ED0180225B7BC32D>110 D E
%EndDVIPSBitmapFont
/Fc 135[50 2[55 33 39 44 55 55 50 55 83 28 55 1[28 55
50 33 44 55 44 55 50 6[66 72 72 100 72 72 66 55 72 1[61
1[72 94 66 78 1[39 78 1[61 66 72 72 66 72 6[33 50 50
50 50 50 50 50 50 50 50 28 25 33 3[33 33 37[55 2[{
TeXBase1Encoding ReEncodeFont}60 99.6264 /Times-Bold
rf /Fd 130[55 55 55 1[55 55 55 55 55 55 55 55 55 55 55
55 55 55 55 1[55 55 55 55 55 55 55 55 55 1[55 1[55 1[55
1[55 55 1[55 55 55 55 55 55 55 55 55 55 55 55 1[55 55
55 1[55 55 55 55 55 2[55 55 55 55 55 3[55 55 2[55 1[55
55 55 55 55 55 55 55 55 1[55 3[55 55 33[{TeXBase1Encoding ReEncodeFont}
72 90.9091 /Courier rf /Fe 139[25 35 30 2[45 45 4[25
1[45 30 40 45 1[45 40 29[61 11[45 45 45 45 45 45 45 49[{
TeXBase1Encoding ReEncodeFont}20 90.9091 /Times-Roman
rf /Ff 134[60 60 60 60 60 60 60 60 1[60 60 60 60 60 60
60 60 60 60 60 60 60 60 60 60 1[60 10[60 60 60 2[60 60
6[60 60 60 60 60 60 60 6[60 60 60 60 60 60 60 60 1[60
60 60 60 60 3[60 60 4[60 35[{TeXBase1Encoding ReEncodeFont}53
99.6264 /Courier rf /Fg 133[39 44 1[66 44 50 28 39 39
1[50 50 50 72 28 44 1[28 50 50 28 44 50 44 50 50 12[55
50 61 1[61 72 66 83 2[44 33 2[61 61 72 66 61 61 6[33
50 1[50 2[50 1[50 50 50 28 25 33 25 44[{TeXBase1Encoding ReEncodeFont}
49 99.6264 /Times-Italic rf /Fh 136[86 1[66 40 47 53
1[66 60 66 100 33 66 1[33 66 60 40 53 66 53 66 60 9[120
2[80 66 6[80 2[47 93 3[86 14[60 60 60 60 60 2[30 40 45[{
TeXBase1Encoding ReEncodeFont}34 119.552 /Times-Bold
rf
%DVIPSBitmapFont: Fi cmsy10 12 1
/Fi 1 16 df<49B4FC010F13E0013F13F8497F48B6FC4815804815C04815E04815F0A248
15F84815FCA3B712FEAA6C15FCA36C15F86C15F0A26C15E06C15C06C15806C15006C6C13
FC6D5B010F13E0010190C7FC27267BAB32>15 D E
%EndDVIPSBitmapFont
/Fj 134[42 1[60 42 42 23 32 28 1[42 42 42 65 23 42 1[23
42 42 28 37 42 37 42 37 9[78 2[51 46 55 1[46 1[60 74
3[28 1[60 46 51 60 55 1[60 14[42 1[42 1[21 28 21 44[{
TeXBase1Encoding ReEncodeFont}41 83.022 /Times-Roman
rf
%DVIPSBitmapFont: Fk cmsy7 7 1
/Fk 1 4 df<1338A50060130C00F8133E00FC137E00FE13FE383FBBF83807FFC0000113
00EA007C48B4FC000713C0383FBBF838FE38FE00FC137E00F8133E0060130C00001300A5
17197B9A22>3 D E
%EndDVIPSBitmapFont
/Fl 104[100 50 1[44 44 24[44 50 50 72 50 50 28 39 33
50 50 50 50 78 28 50 28 28 50 50 33 44 50 44 50 44 33
2[33 1[33 61 72 72 94 72 72 61 55 66 72 55 72 72 89 61
72 39 33 72 72 55 61 72 66 66 72 92 4[28 28 50 50 50
50 50 50 50 50 50 50 28 25 33 25 56 1[33 33 33 1[83 33[55
55 2[{TeXBase1Encoding ReEncodeFont}83 99.6264 /Times-Roman
rf /Fm 136[104 1[80 48 56 64 1[80 72 80 120 40 80 1[40
80 72 48 64 80 64 80 72 14[104 8[56 3[96 1[104 1[104
10[72 72 72 72 72 72 3[48 45[{TeXBase1Encoding ReEncodeFont}32
143.462 /Times-Bold rf /Fn 133[72 4[72 1[72 72 1[72 72
72 72 1[72 1[72 72 1[72 72 72 72 72 72 32[72 17[72 1[72
44[{TeXBase1Encoding ReEncodeFont}20 119.552 /Courier
rf /Fo 134[60 2[60 60 33 47 40 1[60 60 60 93 33 2[33
60 60 40 53 60 53 60 53 6[73 2[113 1[86 1[66 80 1[66
1[86 1[73 86 1[40 86 1[66 73 86 80 80 86 7[60 1[60 1[60
60 60 60 60 60 1[30 40 30 44[{TeXBase1Encoding ReEncodeFont}48
119.552 /Times-Roman rf
%DVIPSBitmapFont: Fp cmsy10 14.4 3
/Fp 3 104 df<140E141FAA0030ED018000F8ED03E000FE150F6C151F01C0147FD87FE0
ECFFC0D83FF8010313803B0FFC0E07FE00D803FFEB1FF8C690388E3FE090393FCE7F8090
260FFFFEC7FC010313F8010013E0EC3F80ECFFE0010313F8010F13FE90393FCE7F809039
FF8E3FE0000390380E1FF8D80FFCEB07FE3B3FF81F03FF80D87FE0010013C0D8FFC0EC7F
E00100141F48150F00F815030030ED0180C791C7FCAA140E2B3378B73C>3
D<EE1FE0ED01FF150F92383FF800EDFFC04A90C7FC4A5A4A5A4A5A4A5A5DA2143F5DB3B1
147F5D14FF92C8FC5B495A495A495AEB3FE0EBFF80D87FFEC9FCEAFFF8A2EA7FFEC66C7E
EB3FE0EB0FF86D7E6D7E6D7E7F81147F81143FB3B181141FA2816E7E6E7E6E7E6E7E6E13
C0ED3FF892380FFFE01501ED001F2B7878D93C>102 D<B4FC13F813FF000313C038007F
F0EB1FF8EB07FC6D7E6D7E6D7F147FA281143FB3B181141F81140F816E7E6E7E6E7E6E6C
7EED3FF092380FFFC0030113E0A2030F13C092383FF000ED7F804A48C7FC4A5A4A5A4A5A
5D141F5D143F5DB3B1147F5DA214FF4990C8FC495A495AEB1FF8EB7FF03803FFC0B5C9FC
13F890CAFC2B7878D93C>I E
%EndDVIPSBitmapFont
/Fq 136[124 2[48 67 57 2[86 86 134 1[86 1[48 1[86 57
76 86 76 86 76 11[124 85[{TeXBase1Encoding ReEncodeFont}17
172.188 /Times-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 72 444 a Fq(Using)43 b(embedded)i(sensors)f(for)f(detecting)i
(netw)n(ork)f(attacks)3827 382 y Fp(\003)367 743 y Fo(Florian)30
b(K)m(erschbaum)243 b(Eugene)30 b(H.)g(Spaf)m(ford)243
b(Die)n(go)30 b(Zamboni)172 942 y(Center)g(for)f(Education)h(and)f
(Research)g(in)h(Information)f(Assurance)g(and)g(Security)1346
1092 y(1315)g(Recitation)h(Building)1516 1241 y(Purdue)f(Uni)m(v)n
(ersity)1195 1390 y(W)-10 b(est)30 b(Laf)o(ayette,)g(IN)g(47907-1315)
527 1540 y Fp(f)p Fn(kerschf,spaf,zamboni)p Fp(g)p Fn(@cer)o(ias.)o
(purd)o(ue.)o(edu)1470 1774 y Fo(September)g(25,)g(2000)-90
2157 y Fm(Abstract)-90 2523 y Fl(Embedded)i(sensors)h(for)h(intrusion)d
(detection)i(consist)-90 2643 y(of)46 b(code)h(added)f(to)g(the)g
(operating)g(system)f(and)i(the)-90 2763 y(programs)29
b(of)g(the)g(hosts)g(where)h(monitoring)d(will)i(tak)o(e)-90
2884 y(place.)65 b(The)37 b(sensors)e(check)i(for)g(speci\002c)f
(conditions)-90 3004 y(that)27 b(indicate)h(an)g(attack)g(is)f(taking)g
(place,)i(or)f(an)g(intru-)-90 3125 y(sion)c(has)g(occurred.)31
b(Embedded)24 b(sensors)g(ha)n(v)o(e)g(adv)n(an-)-90
3245 y(tages)37 b(o)o(v)o(er)g(other)g(data)h(collection)e(techniques)h
(\(usu-)-90 3365 y(ally)d(implemented)e(as)i(separate)h(processes\))f
(in)g(terms)-90 3486 y(of)41 b(reduced)g(host)f(impact,)k(resistance)d
(to)f(attack,)45 b(ef-)-90 3606 y(\002cienc)o(y)d(and)h(ef)n(fecti)n(v)
o(eness)e(of)h(detection.)83 b(W)-8 b(e)43 b(de-)-90
3726 y(scribe)j(the)g(use)h(of)f(embedded)g(sensors)f(in)h(general,)-90
3847 y(and)39 b(their)h(application)e(to)h(the)h(detection)f(of)g
(speci\002c)-90 3967 y(netw)o(ork-based)d(attacks.)64
b(The)36 b(sensors)g(were)g(imple-)-90 4088 y(mented)19
b(in)h(the)g(OpenBSD)h(operating)e(system,)h(and)g(our)-90
4208 y(tests)26 b(sho)n(w)g(a)h(100\045)f(success)g(rate)i(in)e(the)g
(detection)h(of)-90 4328 y(the)34 b(attacks)h(for)g(which)f(sensors)g
(were)h(instrumented.)-90 4449 y(W)-8 b(e)39 b(discuss)e(the)h(sensors)
g(implemented)e(and)j(the)f(re-)-90 4569 y(sults)29 b(obtained,)h(as)h
(well)e(as)h(current)h(and)f(future)g(w)o(ork)-90 4689
y(in)24 b(the)h(area.)p -90 5031 800 4 v 21 5092 a Fk(\003)59
5122 y Fj(Portions)16 b(of)f(this)i(w)o(ork)e(were)h(supported)e(by)h
(sponsors)g(of)h(CE-)-90 5222 y(RIAS.)23 b(This)h(paper)e(w)o(as)h
(published)f(in)h(Proceedings)e(of)i(the)g(First)-90
5321 y(A)m(CM)d(W)-7 b(orkshop)19 b(on)g(Intrusion)f(Detection)i
(Systems,)g(No)o(v)o(ember)-90 5421 y(2000,)f(Athens,)g(Greece.)1992
2157 y Fm(1)143 b(Intr)m(oduction)1992 2396 y Fl(The)40
b(\002eld)i(of)f(intrusion)e(detection)h(has)h(recei)n(v)o(ed)f(in-)
1992 2517 y(creasing)29 b(attention)f(in)g(recent)i(years.)44
b(One)30 b(reason)f(for)1992 2637 y(this)24 b(is)h(the)g(e)o(xplosi)n
(v)o(e)e(gro)n(wth)i(of)g(the)g(Internet)h(and)f(the)1992
2757 y(lar)n(ge)c(number)f(of)h(netw)o(ork)o(ed)f(systems)f(that)i(e)o
(xist)e(in)h(all)1992 2878 y(types)32 b(of)h(or)n(ganizations.)54
b(The)33 b(increase)h(in)f(the)g(num-)1992 2998 y(ber)24
b(of)h(netw)o(ork)o(ed)f(machines)g(has)g(lead)h(to)f(an)h(increase)
1992 3119 y(in)32 b(unauthorized)h(acti)n(vity)f([6],)k(not)c(only)h
(from)g(e)o(xter)n(-)1992 3239 y(nal)21 b(attack)o(ers,)i(b)n(ut)e
(also)g(from)h(internal)f(attack)o(ers,)h(such)1992 3359
y(as)h(disgruntled)f(emplo)o(yees)h(and)g(people)h(ab)n(using)e(their)
1992 3480 y(pri)n(vile)o(ges)g(for)j(personal)g(gain)f([27].)2089
3608 y(T)-8 b(o)33 b(detect)g(and)g(counteract)h(unauthorized)e(acti)n
(vity)-6 b(,)1992 3728 y(it)28 b(is)g(desirable)g(for)h(netw)o(ork)f
(and)h(system)e(administra-)1992 3848 y(tors)d(to)g(monitor)f(acti)n
(vity)g(in)h(their)g(netw)o(orks.)30 b(Because)1992 3969
y(e)n(v)o(en)25 b(a)j(single)d(host)h(can)i(generate)f(se)n(v)o(eral)f
(me)o(gabytes)1992 4089 y(of)21 b(logging)e(and)i(audit)g(data)g(in)f
(a)i(single)e(day)-6 b(,)21 b(it)g(is)f(desir)n(-)1992
4210 y(able)32 b(to)h(ha)n(v)o(e)g(tools)e(that)i(can)g(automatically)e
(monitor)1992 4330 y(computer)37 b(systems)f(and)i(detect)f(when)h
(unauthorized)1992 4450 y(acti)n(vity)21 b(is)j(taking)e(place.)31
b(These)23 b(tools)g(are)h(commonly)1992 4571 y(kno)n(wn)f(as)i
(intrusion)e(detection)h(systems.)2089 4699 y(In)32 b(the)g(last)f(fe)n
(w)h(years)g(a)g(number)g(of)g(intrusion)e(de-)1992 4819
y(tection)i(systems)f(ha)n(v)o(e)i(been)g(de)n(v)o(eloped,)g(both)f(in)
g(the)1992 4939 y(commercial)27 b(and)h(academic)g(sectors.)40
b(These)28 b(systems)1992 5060 y(ha)n(v)o(e)g(used)g(dif)n(ferent)h
(approaches)g(to)f(detecting)g(unau-)1992 5180 y(thorized)33
b(acti)n(vity)-6 b(,)34 b(and)g(ha)n(v)o(e)g(gi)n(v)o(en)f(us)g(some)h
(insight)1992 5301 y(into)f(the)h(problems)f(that)h(still)f(ha)n(v)o(e)
h(to)g(be)h(solv)o(ed)e(be-)1992 5421 y(fore)e(we)f(can)h(ha)n(v)o(e)g
(intrusion)e(detection)g(systems)h(that)1925 5670 y(1)p
eop
%%Page: 2 2
2 1 bop -90 137 a Fl(are)38 b(useful)f(and)g(reliable)g(in)g
(production)f(settings)f(for)-90 257 y(detecting)24 b(a)h(wide)g(range)
g(of)g(intrusions.)8 378 y(Most)90 b(of)i(the)f(e)o(xisting)e
(intrusion)h(detection)-90 498 y(systems)70 b(ha)n(v)o(e)i(used)f
(central)h(data)g(analysis)e(en-)-90 618 y(gines)d([e.g.)25
b(10)o(,)g(17])68 b(or)f(per)n(-host)g(data)h(collection)-90
739 y(and)c(analysis)f(components)f([e.g.)25 b(15,)g(26)o(].)148
b(Ev)o(en)-90 859 y(systems)25 b(designed)g(using)h(softw)o(are)g
(agents)g([e.g.)f(2,)g(3)o(])-90 980 y(ha)n(v)o(e)39
b(in)g(practice)h(implemented)e(agents)h(as)g(separate)-90
1100 y(processes.)53 b(All)32 b(of)g(these)g(approaches)g(are)h
(subject)f(to)-90 1220 y(the)25 b(follo)n(wing)d(problems:)7
1415 y Fi(\017)48 b Fl(The)o(y)19 b(continuously)f(use)i(additional)f
(resources)h(in)105 1535 y(the)40 b(system)f(the)o(y)h(are)g
(monitoring,)i(e)n(v)o(en)e(when)105 1656 y(there)25
b(are)h(no)e(intrusions)f(occurring.)7 1856 y Fi(\017)48
b Fl(Because)31 b(the)f(components)f(of)i(the)f(intrusion)e(de-)105
1976 y(tection)40 b(system)g(are)h(implemented)e(as)i(separate)105
2097 y(processes,)31 b(the)o(y)d(are)j(subject)e(to)g(tampering.)44
b(An)105 2217 y(intruder)24 b(can)h(potentially)e(disable)h(or)h
(modify)f(the)105 2338 y(programs)j(running)g(on)h(a)g(system,)f
(rendering)h(the)105 2458 y(intrusion)34 b(detection)g(system)g
(useless)h(or)g(unreli-)105 2578 y(able.)8 2773 y(In)26
b(this)f(document)g(we)i(sho)n(w)e(the)h(use)g(of)g(embedded)-90
2893 y(sensors)37 b(to)g(detect)g(a)h(speci\002c)f(set)h(of)f(netw)o
(ork-based)-90 3014 y(attacks.)64 b(These)35 b(sensors)h(are)g(b)n
(uilt)f(into)g(the)g(code)i(of)-90 3134 y(the)i(operating)f(system.)73
b(This)38 b(mak)o(es)h(them)f(use)h(ad-)-90 3254 y(ditional)27
b(resources)i(only)e(when)h(the)o(y)g(are)h(e)o(x)o(ecuted)f(or)-90
3375 y(triggered,)c(and)h(be)g(more)g(resistant)f(to)g(tampering.)-90
3668 y Fh(1.1)119 b(Intrusion)30 b(Detection)-90 3856
y Fl(Intrusion)k(detection)h(is)g(de\002ned)h(as)g(\223the)g(problem)f
(of)-90 3976 y(identifying)30 b(indi)n(viduals)f(who)j(are)g(using)f(a)
h(computer)-90 4097 y(system)26 b(without)g(authorization)g(\(i.e.,)i
(`crack)o(ers'\))h(and)-90 4217 y(those)43 b(who)g(ha)n(v)o(e)g(le)o
(gitimate)f(access)h(to)g(the)h(system)-90 4337 y(b)n(ut)37
b(are)h(ab)n(using)f(their)g(pri)n(vile)o(ges)e(\(i.e.,)41
b(the)c(`insider)-90 4458 y(threat'\)\224)31 b([21].)49
b(W)-8 b(e)32 b(add)f(to)f(this)g(de\002nition)g(the)h(iden-)-90
4578 y(ti\002cation)44 b(of)i Fg(attempts)d Fl(to)i(use)g(a)g(computer)
g(system)-90 4699 y(without)40 b(authorization)h(or)g(to)g(ab)n(use)h
(e)o(xisting)e(pri)n(vi-)-90 4819 y(le)o(ges.)88 b(Our)44
b(w)o(orking)g(de\002nition)f(matches)h(the)g(one)-90
4939 y(gi)n(v)o(en)32 b(by)h(Heady)h(et)f(al.)g([14],)j(where)e(an)f
(intrusion)f(is)-90 5060 y(de\002ned)26 b(as)f(\223an)o(y)g(set)g(of)h
(actions)f(that)f(attempt)h(to)g(com-)-90 5180 y(promise)k(the)h(inte)o
(grity)-6 b(,)28 b(con\002dentiality)-6 b(,)30 b(or)g(a)n(v)n(ailabil-)
-90 5301 y(ity)24 b(of)i(a)f(resource,)-7 b(\224)26 b(disre)o(garding)d
(the)i(success)g(or)h(f)o(ail-)-90 5421 y(ure)f(of)g(those)f(actions.)
2089 137 y(The)34 b(de\002nition)e(of)i(the)f(w)o(ord)h
Fg(intrusion)d Fl(in)i(a)h(com-)1992 257 y(mon)c(dictionary)g([19)o(])h
(does)g(not)f(include)g(the)h(concept)1992 378 y(of)h(an)g(insider)g
(ab)n(using)f(his)h(or)g(her)g(pri)n(vile)o(ges)f(to)h(per)n(-)1992
498 y(form)25 b(unauthorized)f(actions,)h(or)g(attempting)f(to)h(do)g
(so.)1992 618 y(A)g(more)h(accurate)h(phrase)f(to)f(use)h(is)f
Fg(intrusion)f(and)h(in-)1992 739 y(sider)c(ab)n(use)h(detection)p
Fl(.)30 b(In)22 b(this)g(document)f(we)i(use)f(the)1992
859 y(term)30 b Fg(intrusion)f Fl(to)h(mean)h(both)f(intrusion)f(and)i
(insider)1992 980 y(ab)n(use.)2089 1109 y(An)19 b(intrusion)f
(detection)g(system)g(is)h(a)h(computer)f(sys-)1992 1230
y(tem)j(\(possibly)g(a)h(combination)e(of)j(softw)o(are)f(and)g(hard-)
1992 1350 y(w)o(are\))h(that)f(attempts)g(to)g(perform)h(intrusion)e
(detection,)1992 1470 y(as)40 b(de\002ned)g(abo)o(v)o(e.)76
b(Most)39 b(intrusion)f(detection)i(sys-)1992 1591 y(tems)22
b(try)i(to)f(perform)h(their)f(task)h(in)f(real)h(time)f([21],)h(b)n
(ut)1992 1711 y(there)33 b(are)h(also)f(intrusion)e(detection)i
(systems)f(that)g(do)1992 1831 y(not)24 b(operate)g(in)h(real)g(time,)f
(either)g(due)h(to)f(the)g(nature)h(of)1992 1952 y(the)e(analysis)f
(the)o(y)g(perform)i([e.g.)f(16)o(])h(or)f(because)h(the)o(y)1992
2072 y(are)h(geared)g(for)h(forensic)e(analysis)g([11,)h(36)o(].)2089
2202 y(Intrusion)38 b(detection)h(systems)e(are)j(usually)e(classi-)
1992 2322 y(\002ed)g(as)g(host-based)f(or)h(netw)o(ork-based)f([21].)70
b(Host-)1992 2443 y(based)25 b(systems)g(base)h(their)f(decisions)g(on)
h(information)1992 2563 y(obtained)32 b(from)i(a)g(single)e(host)h
(\(usually)g(audit)g(trails\),)1992 2683 y(while)24 b(netw)o(ork-based)
h(systems)e(obtain)i(data)g(by)g(mon-)1992 2804 y(itoring)c(the)h(traf)
n(\002c)h(in)f(the)h(netw)o(ork)f(to)g(which)g(the)g(hosts)1992
2924 y(are)j(connected.)2089 3054 y(The)32 b(de\002nition)f(of)g(an)h
(intrusion)e(detection)h(system)1992 3174 y(does)24 b(not)h(include)f
(pre)n(v)o(enting)g(the)g(intrusion)g(from)h(oc-)1992
3295 y(curring,)f(only)f(detecting)h(it)f(and)i(reporting)e(it)h(to)g
(an)g(op-)1992 3415 y(erator)-5 b(.)30 b(There)23 b(are)h(some)f
(intrusion)f(detection)g(systems)1992 3535 y(\(for)e(e)o(xample,)g
(NetRanger)g([8]\))g(that)g(try)f(to)h(react)g(when)1992
3656 y(the)o(y)30 b(detect)i(an)g(unauthorized)f(action.)50
b(This)31 b(reaction)1992 3776 y(usually)23 b(includes)g(trying)g(to)h
(contain)g(or)g(stop)f(the)h(dam-)1992 3896 y(age,)38
b(for)d(e)o(xample,)i(by)e(terminating)f(a)h(netw)o(ork)g(con-)1992
4017 y(nection.)1992 4371 y Fh(1.2)119 b(Detecting)30
b(netw)o(ork)h(attacks)1992 4578 y Fl(In)23 b(the)g(last)g(fe)n(w)g
(years,)h(the)f(number)g(of)g(remote)g(attacks)1992 4699
y(using)31 b(the)i(TCP/IP)h(protocol)e(suite)g([9])h(has)g(gro)n(wn)e
(in)1992 4819 y(number)-5 b(.)80 b(This)42 b(has)f(been)i(caused)f(in)f
(lar)n(ge)h(part)g(by)1992 4939 y(the)h(kno)n(wn)g(design)g(\003a)o(ws)
h(in)g(the)g(TCP/IP)h(protocol)1992 5060 y(suite)30 b([4],)i(and)f(by)g
(the)f(e)o(xplosi)n(v)o(e)f(gro)n(wth)h(of)g(systems)1992
5180 y(using)23 b(TCP/IP)j(that)e(are)h(connected)f(to)g(the)h
(Internet.)30 b(A)1992 5301 y(lar)n(ge)i(number)f(of)h(netw)o(ork)f
(attacks)h(ha)n(v)o(e)f(been)h(made)1992 5421 y(public,)25
b(including)f(source)j(code)f(for)g(e)o(xploiting)e(them.)1925
5670 y(2)p eop
%%Page: 3 3
3 2 bop -90 137 a Fl(Some)19 b(of)g(these)g(attacks)g(e)o(xploit)f(f)o
(aults)g(in)h(the)g(netw)o(ork-)-90 257 y(ing)h(code)g(of)g(operating)g
(systems,)g(while)f(others)h(e)o(xploit)-90 378 y(basic)25
b(vulnerabilities)e(of)h(the)h(TCP/IP)h(protocol)e(suite.)8
694 y(Man)o(y)32 b(netw)o(ork)g(attacks)h(are)h(denial-of-service)f
(at-)-90 815 y(tacks,)d(which)g(cause)f(disruption)f(of)i(the)f
(services)h(pro-)-90 935 y(vided)36 b(by)g(the)h(attack)o(ed)f(host.)65
b(Others)36 b(allo)n(w)g(the)g(at-)-90 1056 y(tack)o(er)28
b(to)g(gain)f(unauthorized)g(access)i(to)e(resources)i(of)-90
1176 y(services)19 b(of)n(fered)h(by)f(the)g(attack)o(ed)h(host,)f(and)
g(others)g(al-)-90 1296 y(lo)n(w)j(the)i(attack)o(er)f(to)g(gain)g
(information)e(about)i(the)g(host)-90 1417 y(that)h(can)i(be)e(used)h
(to)f(mount)g(further)h(attacks.)8 1733 y(This)33 b(document)g(focuses)
h(on)g(an)g(ef)n(fort)g(to)g(pro)o(vide)-90 1854 y(real-time)39
b(detection)g(of)h(a)g(set)g(of)g(common)e(netw)o(ork)-90
1974 y(attacks.)82 b(Other)42 b(intrusion)e(detection)h(systems)g(ha)n
(v)o(e)-90 2095 y(implemented)32 b(detection)h(of)h(these)f(attacks,)j
(b)n(ut)d(most)-90 2215 y(of)i(them)e(ha)n(v)o(e)i(implemented)e(the)h
(detectors)g(as)h(inde-)-90 2335 y(pendent)e(processes)g(that)g(gather)
g(and)g(interpret)g(pack-)-90 2456 y(ets)42 b(\003o)n(wing)e(on)i(the)g
(netw)o(ork.)81 b(This)41 b(approach)h(im-)-90 2576 y(poses)37
b(an)h(e)o(xtra)f(load)h(on)f(the)h(system)e(where)i(the)g(in-)-90
2696 y(trusion)23 b(detection)g(system)f(is)h(running)g(\(because)h(it)
g(has)-90 2817 y(to)43 b(process)h(all)f(the)h(pack)o(ets)f(that)h
(pass)f(through)g(the)-90 2937 y(netw)o(ork\),)37 b(introduces)e(an)g
(e)o(xtra)g(delay)g(in)g(the)g(detec-)-90 3058 y(tion)28
b(of)g(the)g(attacks)g(\(because)h(the)g(pack)o(et)f(data)h(has)f(to)
-90 3178 y(be)g(passed)f(from)g(the)g(netw)o(orking)f(layers)i(of)f
(the)g(oper)n(-)-90 3298 y(ating)36 b(system)f(to)h(a)h(user)n(-le)n(v)
o(el)e(process)i(for)f(interpre-)-90 3419 y(tation\))k(and)h(is)f
(subject)g(to)h(attacks)f(as)h(described)g(by)-90 3539
y(Ptacek)25 b(and)g(Ne)n(wsham)f([28].)8 3856 y(W)-8
b(e)33 b(describe)f(a)h(dif)n(ferent)g(approach)g(to)f(the)g(imple-)-90
3976 y(mentation)h(of)i(the)g(detectors:)50 b(inserting)34
b(them)g(in)h(the)-90 4097 y(netw)o(orking)20 b(code)h(of)g(the)f
(attack)o(ed)h(host.)29 b(Small)20 b(detec-)-90 4217
y(tors,)34 b(called)f Fg(embedded)g(sensor)o(s)p Fl(,)g(for)g
(speci\002c)h(attack)-90 4337 y(signatures)28 b(are)h(placed)g(within)e
(the)i(Unix)f(k)o(ernel)g(code)-90 4458 y(that)e(processes)h(netw)o
(ork)f(pack)o(ets.)36 b(This)25 b(tak)o(es)i(adv)n(an-)-90
4578 y(tage)c(of)f(the)h(processing)f(that)g(the)g(k)o(ernel)h(already)
g(does,)-90 4699 y(therefore)k(reducing)f(system)f(load.)34
b(Also,)26 b(because)h(the)-90 4819 y(sensors)22 b(are)h(placed)f(in)g
(the)h(code)f(se)o(gment)f(determined)-90 4939 y(to)j(be)h(responsible)
f(for)h(the)f(\003a)o(w)-6 b(,)25 b(the)o(y)f(can)h(reliably)f(in-)-90
5060 y(dicate)f(an)f(attack,)h(reducing)f(the)h(number)f(of)h(both)e(f)
o(alse)-90 5180 y(positi)n(v)o(es)26 b(and)i(f)o(alse)g(ne)o(gati)n(v)o
(es.)39 b(Finally)-6 b(,)28 b(because)h(the)-90 5301
y(sensors)34 b(become)h(part)g(of)g(the)g(k)o(ernel)g(code,)j(the)o(y)c
(are)-90 5421 y(v)o(ery)24 b(dif)n(\002cult)g(to)h(disable)f(or)h
(tamper)f(with.)1992 137 y Fm(2)143 b(Embedded)43 b(sensors)h(f)l(or)h
(intru-)2207 319 y(sion)35 b(detection)1992 553 y Fl(W)-8
b(e)29 b(de\002ne)g(an)g Fg(embedded)g(sensor)i Fl(as)e(a)g(piece)g(of)
g(soft-)1992 674 y(w)o(are)k(\(concei)n(v)n(ably)e(aided)i(by)f(some)g
(hardw)o(are)h(com-)1992 794 y(ponents\))26 b(that)g(monitors)g(a)h
(speci\002c)h(v)n(ariable,)f(acti)n(vity)1992 914 y(or)34
b(condition)f(of)i(a)g(host.)59 b(Because)35 b(the)g(sensor)f(mon-)1992
1035 y(itors)29 b(the)h(system)g(directly)g(and)g(not)g(through)f(an)i
(audit)1992 1155 y(trail)19 b(or)h(through)e(pack)o(ets)i(on)f(a)i
(netw)o(ork,)f(we)g(say)f(that)h(it)1992 1275 y(performs)31
b Fg(dir)l(ect)h(monitoring)p Fl(,)g(and)g(because)h(the)f(sen-)1992
1396 y(sor)j(is)g(part)g(of)g(the)g(program)g(or)h(system)e(it)h
(monitors,)1992 1516 y(we)25 b(say)f(that)h(it)f(is)g(an)h
Fg(internal)f(sensor)i Fl([33].)2089 1641 y(Embedded)40
b(sensors)f(are)i(b)n(uilt)f(by)g(modifying)e(the)1992
1762 y(source)21 b(code)h(of)g(the)g(program)f(that)h(will)f(be)h
(monitored.)1992 1882 y(Sensors)33 b(should)g(be)h(added)g(to)f(the)h
(code)g(at)g(the)f(point)1992 2003 y(where)k(a)h(security)f(problem)g
(can)g(be)h(detected)f(in)g(the)1992 2123 y(most)d(ef)n(\002cient)i(w)o
(ay)f(by)h(using)e(the)i(data)f(a)n(v)n(ailable)g(at)1992
2243 y(that)g(moment.)64 b(If)37 b(implemented)e(correctly)-6
b(,)39 b(the)d(sen-)1992 2364 y(sor)29 b(will)f(be)i(able)g(to)f
(determine)g(whether)g(an)h(attack)g(is)1992 2484 y(taking)23
b(place)j(by)e(performing)g(v)o(ery)h(simple)e(checks.)1992
2811 y Fh(2.1)119 b(Ho)o(w)29 b(sensors)g(w)o(ork)1992
3008 y Fl(Figure)h(1)h(sho)n(ws)f(an)g(e)o(xample)g(of)h(a)g(v)o(ery)g
(simple)e(sen-)1992 3129 y(sor)-5 b(.)42 b(The)29 b(code)g(on)g(the)g
(left)g(is)f(potentially)f(vulnerable)1992 3249 y(to)20
b(a)i(b)n(uf)n(fer)n(-o)o(v)o(er\003o)n(w)e(attack)h([1])h(because)f
(the)g(v)n(alue)g(of)1992 3370 y(the)35 b(HOME)f(en)l(vironment)g(v)n
(ariable)h(is)g(being)f(copied)1992 3490 y(to)40 b(a)g(b)n(uf)n(fer)h
(without)e(checking)h(its)g(length.)77 b(On)40 b(the)1992
3610 y(right,)h(lines)e(2\2266)f(ha)n(v)o(e)h(been)g(added,)k(and)c
(constitute)1992 3731 y(a)33 b(sensor)-5 b(.)56 b(This)33
b(sensor)g(computes)f(the)h(length)g(of)g(the)1992 3851
y(HOME)38 b(en)l(vironment)h(v)n(ariable,)j(and)e(if)f(it)g(is)g
(longer)1992 3971 y(than)26 b(the)g(b)n(uf)n(fer)g(into)g(which)g(it)g
(will)f(be)i(copied)f(it)g(gen-)1992 4092 y(erates)44
b(an)g(alert.)89 b(This)43 b(e)o(xample)g(assumes)h(that)f(the)1992
4212 y(function)22 b Ff(log)p 2533 4212 30 4 v 35 w(alert)h
Fl(has)g(been)g(de\002ned)h(else)n(where.)1992 4333 y(Of)f(course,)h
(the)f(string)f(\223b)n(uf)n(fer)i(o)o(v)o(er\003o)n(w\224)e(is)h(pro)o
(vided)1992 4453 y(only)30 b(as)i(an)f(e)o(xample\227in)f(a)i(real)g
(sensor)l(,)h(a)e(more)h(de-)1992 4573 y(scripti)n(v)o(e)23
b(message)h(w)o(ould)g(be)h(pro)o(vided.)2089 4699 y(The)c(e)o(xample)f
(in)g(Figure)i(1,)f(as)g(per)g(our)g(de\002nition)f(of)1992
4819 y(sensor)l(,)34 b(does)f(not)f(try)h(to)f(pre)n(v)o(ent)g(the)h(o)
o(v)o(er\003o)n(w)e(from)1992 4939 y(happening,)24 b(it)h(only)g(tries)
g(to)g(note)g(its)f(occurrence.)34 b(Po-)1992 5060 y(tentially)-6
b(,)39 b(sensors)e(could)h(try)f(to)h(stop)f(the)h(intrusions)1992
5180 y(the)o(y)23 b(detect.)30 b(F)o(or)25 b(e)o(xample,)e(our)h
(sample)g(sensor)g(could)1992 5301 y(cut)30 b(the)g(HOME)g(en)l
(vironment)f(v)n(ariable)h(to)g(255)g(char)n(-)1992 5421
y(acters)47 b(to)g(ensure)h(that)e(it)h(will)g(\002t)g(in)g(the)g
(allocated)1925 5670 y(3)p eop
%%Page: 4 4
4 3 bop -51 116 a Fe(1)137 b Fd(char)52 b(buf[256];)-51
188 y Fe(2)137 b Fd(strcpy\(buf,)49 b(getenv\("HOME"\)\))o(;)p
1757 569 4 532 v 1838 116 a Fe(1)136 b Fd(char)53 b(buf[256];)1838
188 y Fe(2)136 b Fd({)1838 260 y Fe(3)246 b Fd(if)53
b(\(strlen\(getenv\()o("H)o(OME)o("\))o(\)>)o(25)o(5\))48
b({)1838 336 y Fe(4)355 b Fd(log_alert\("buf)o(fe)o(r)48
b(overflow"\);)1838 412 y Fe(5)246 b Fd(})1838 484 y
Fe(6)136 b Fd(})1838 555 y Fe(7)g Fd(strcpy\(buf,)50
b(getenv\("HOME"\)\))o(;)293 648 y Fe(Code)24 b(before)h(inserting)h
(sensor)1072 b(Code)24 b(after)g(inserting)i(sensor)252
841 y Fl(Figure)f(1:)32 b(Example)24 b(of)h(vulnerable)f(code)h(before)
g(and)g(after)h(inserting)d(an)i(embedded)f(sensor)-5
b(.)-90 1236 y(b)n(uf)n(fer)g(.)41 b(Ho)n(we)n(v)o(er)l(,)28
b(the)g(ef)n(fects)g(of)h(sensors)e(modifying)-90 1357
y(data)g(or)f(altering)g(the)h(program)f(\003o)n(w)h(are)g(much)f
(harder)-90 1477 y(to)31 b(analyze.)52 b(F)o(or)31 b(this)g(reason,)i
(our)e(current)h(w)o(ork)g(has)-90 1597 y(focused)k(on)f(using)f
(embedded)i(sensors)f(only)f(for)i(de-)-90 1718 y(tection.)8
1839 y(This)g(e)o(xample)g(gi)n(v)o(es)f(an)j(idea)f(of)g(ho)n(w)f
(embedded)-90 1960 y(sensors)25 b(w)o(ork)h(in)f(general:)33
b(the)o(y)25 b(look)g(at)g(the)h(informa-)-90 2080 y(tion)c(a)n(v)n
(ailable)h(in)g(the)g(program)g(to)f(determine)h(if)g(an)h(in-)-90
2200 y(trusion)c(has)g(occurred,)j(or)d(if)h(an)g(attack)g(is)f(taking)
g(place.)-90 2321 y(If)25 b(such)g(a)g(condition)e(is)i(found,)f(an)h
(alert)g(is)f(generated.)-90 2623 y Fh(2.2)119 b(What)75
b(is)g(good)g(about)h(embedded)179 2772 y(sensors)-90
2962 y Fl(Using)29 b(embedded)h(sensors)f(for)i(data)f(collection)f(in)
g(an)-90 3082 y(intrusion)38 b(detection)g(system)g(has)h(the)g(follo)n
(wing)e(ad-)-90 3203 y(v)n(antages)18 b(o)o(v)o(er)h(using)f(e)o
(xternal)h(sensors)f(\(implemented)-90 3323 y(as)25 b(separate)g
(programs\):)7 3559 y Fi(\017)48 b Fl(The)o(y)35 b(can)g(obtain)f(data)
h(at)g(its)g(source,)i(or)f(at)f(the)105 3679 y(place)g(where)f(it)g
(is)g(more)g(con)l(v)o(enient)f(to)h(obtain.)105 3800
y(Data)25 b(does)g(not)g(ha)n(v)o(e)g(to)f(tra)n(v)o(erse)h(through)f
(an)i(e)o(x-)105 3920 y(ternal)i(program)h(interf)o(ace)g(for)f(the)h
(sensor)f(to)g(get)105 4040 y(it,)k(because)f(the)g(sensor)f(can)h
(read)g(it)g(directly)f(of)n(f)105 4161 y(the)37 b(program')-5
b(s)37 b(data)g(structures.)68 b(This)36 b(reduces)105
4281 y(the)31 b(delay)h(between)f(the)h(generation)f(of)g(the)h(data)
105 4402 y(and)f(when)g(the)g(intrusion)f(detection)g(system)g(can)105
4522 y(mak)o(e)25 b(use)f(of)h(it.)7 4731 y Fi(\017)48
b Fl(Data)36 b(is)f(ne)n(v)o(er)f(stored)h(on)g(an)h(e)o(xternal)f
(medium)105 4851 y(before)30 b(the)g(sensor)f(obtains)f(them,)i
(therefore)h(the)105 4971 y(possibility)e(of)k(an)f(intruder)f
(modifying)g(the)h(data)105 5092 y(to)42 b(hide)g(its)g(tracks)h(\(for)
f(e)o(xample,)k(an)d(intruder)105 5212 y(modifying)19
b(a)i(log)f(\002le\))h(is)f(practically)g(eliminated.)7
5421 y Fi(\017)48 b Fl(Embedded)43 b(sensors)h(are)h(part)f(of)g(the)g
(program)2187 1236 y(the)o(y)d(monitor)l(,)k(therefore)e(the)o(y)e
(cannot)h(be)h(dis-)2187 1357 y(abled)19 b(\(as)h(it)f(is)g(possible)f
(with)h(an)h(e)o(xternal)f(sensor)l(,)2187 1477 y(which)26
b(can)i(be)f(killed)f(or)h(disabled\))f(and)h(the)o(y)f(are)2187
1597 y(v)o(ery)32 b(dif)n(\002cult)g(to)g(modify)g(to)g(produce)h
(incorrect)2187 1718 y(results.)2088 1921 y Fi(\017)49
b Fl(Embedded)40 b(sensors)h(can)h(analyze)f(the)g(data)h(\(at)2187
2042 y(least)j(partially\))g(at)h(the)g(moment)f(the)o(y)g(are)h(ac-)
2187 2162 y(quired,)26 b(therefore)g(reducing)g(impact)f(on)h(the)g
(host)2187 2282 y(due)d(to)h(data)g(tra)n(v)o(ersing)f(between)h(dif)n
(ferent)f(com-)2187 2403 y(ponents)i(\(and)i(possibly)f(between)g(dif)n
(ferent)h(con-)2187 2523 y(te)o(xts)19 b(in)h(the)g(operating)f
(system,)h(such)g(as)h(user)f(and)2187 2644 y(k)o(ernel)k(conte)o(xts)g
(in)g(a)i(Unix)e(system\).)2088 2847 y Fi(\017)49 b Fl(Embedded)i
(sensors)g(can)h(look)f(for)h(v)o(ery)f(spe-)2187 2967
y(ci\002c)d(conditions)e(that)i(signal)f(attacks,)53
b(instead)2187 3088 y(of)37 b(reporting)g(generic)h(data)f(for)h
(analysis.)68 b(This)2187 3208 y(means)19 b(that)h(the)g(amount)f(of)h
(data)h(that)e(needs)h(to)g(be)2187 3329 y(reported,)43
b(collected)d(and)g(analyzed)g(by)f(higher)n(-)2187 3449
y(le)n(v)o(el)20 b(analysis)h(engines)g(is)h(much)f(smaller)l(,)h
(reduc-)2187 3569 y(ing)i(both)g(netw)o(ork)g(traf)n(\002c)i(and)e
(processing)g(load.)2088 3773 y Fi(\017)49 b Fl(Embedded)42
b(sensors)h(are)i(only)d(e)o(x)o(ecuted)h(when)2187 3893
y(the)51 b(task)h(the)o(y)f(perform)g(is)h(required)g(\(this)f(is,)2187
4014 y(when)37 b(the)g(section)g(of)h(code)g(the)o(y)e(are)j(a)e(part)h
(of)2187 4134 y(is)23 b(e)o(x)o(ecuted\))g(and)g(the)o(y)g(are)h(not)g
(e)o(x)o(ecuted)e(as)i(sep-)2187 4254 y(arate)33 b(processes)g(or)f
(threads,)j(b)n(ut)d(as)h(part)f(of)h(the)2187 4375 y(monitored)28
b(program.)45 b(F)o(or)30 b(this)f(reason,)i(the)o(y)d(do)2187
4495 y(not)j(cause)h(a)g(continuous)e(CPU)i(usage)g(o)o(v)o(erhead)2187
4616 y(on)e(the)h(host.)48 b(This)30 b(mak)o(es)g(it)g(possible)g(to)g
(incor)n(-)2187 4736 y(porate)39 b(a)h(much)f(lar)n(ger)i(number)e(of)g
(sensors)g(on)2187 4856 y(a)c(single)f(host)g(than)h(it)f(w)o(ould)g
(be)h(possible)f(on)h(a)2187 4977 y(system)19 b(where)j(all)f(the)g
(sensors)f(are)i(implemented)2187 5097 y(e)o(xternally)h([34].)2088
5301 y Fi(\017)49 b Fl(Embedded)62 b(sensors)g(can)h(look)f(for)h
(attempts)2187 5421 y(to)44 b(e)o(xploit)g(a)h(vulnerability)-6
b(,)48 b(independently)c(of)1925 5670 y(4)p eop
%%Page: 5 5
5 4 bop 105 137 a Fl(whether)47 b(the)f(vulnerability)f(actually)h(e)o
(xists)f(in)105 257 y(the)26 b(host)e(where)j(the)e(sensor)g(is)h
(running.)32 b(F)o(or)26 b(this)105 378 y(reason,)21
b(embedded)f(sensors)f(can)i(detect)f(attempts)105 498
y(at)31 b(intrusions)e(that)h(ha)n(v)o(e)g(already)i(been)e(\002x)o
(ed,)j(or)105 618 y(e)n(v)o(en)g(that)h(are)g(speci\002c)h(to)e(a)i
(dif)n(ferent)e(platform)105 739 y(or)26 b(operating)f(system)g(\(for)h
(e)o(xample,)f(a)h(sensor)f(in)105 859 y(a)f(Unix)f(system)f(could)h
(detect)h(attacks)f(speci\002c)h(to)105 980 y(W)l(indo)n(ws)f(NT\).)-90
1315 y Fh(2.3)119 b(What)29 b(is)h(bad)g(about)g(embedded)i(sen-)179
1464 y(sors)-90 1665 y Fl(Embedded)40 b(sensors)g(ha)n(v)o(e)g(the)g
(follo)n(wing)f(disadv)n(an-)-90 1786 y(tages)25 b(with)f(respect)h(to)
f(e)o(xternal)g(sensors:)7 2058 y Fi(\017)48 b Fl(Their)29
b(implementation)e(requires)i(ha)n(ving)g(access)105
2178 y(to)19 b(the)g(source)g(code)h(of)f(the)g(operating)g(system)f
(and)105 2299 y(its)24 b(programs.)7 2534 y Fi(\017)48
b Fl(The)o(y)19 b(are)h(more)f(dif)n(\002cult)f(to)h(implement,)f
(because)105 2654 y(the)o(y)26 b(require)h(modi\002cations)e(to)i(the)f
(source)h(code)105 2774 y(of)e(the)g(operating)f(system)f(or)i(its)f
(programs.)7 3009 y Fi(\017)48 b Fl(The)o(y)20 b(ha)n(v)o(e)g(to)g(be)h
(implemented)e(in)h(the)g(same)h(lan-)105 3130 y(guage)j(as)f(the)h
(program)f(in)g(which)g(the)o(y)g(are)h(being)105 3250
y(incorporated.)7 3485 y Fi(\017)48 b Fl(The)o(y)55 b(ha)n(v)o(e)h(the)
g(potential)f(of)h(causing)f(much)105 3605 y(more)22
b(damage)h(to)f(the)g(system)f(if)i(the)o(y)e(contain)h(er)n(-)105
3726 y(rors.)33 b(A)26 b(piece)g(of)g(code)g(embedded)f(in)g(the)h(k)o
(ernel)105 3846 y(of)g(a)h(Unix)e(system)g(can)i(bring)e(the)h(whole)g
(system)105 3966 y(do)n(wn)e(if)h(it)f(acts)h(incorrectly)-6
b(.)7 4201 y Fi(\017)48 b Fl(Improperly)36 b(implemented)e(sensors)h
(\(for)i(e)o(xam-)105 4322 y(ple,)28 b(one)f(that)g(repeatedly)h(e)o(x)
o(ecutes)e(a)i(costly)f(op-)105 4442 y(eration\))39 b(can)g(ha)n(v)o(e)
f(detrimental)g(ef)n(fects)g(on)h(the)105 4563 y(performance)25
b(of)g(the)f(system.)29 b(Because)d(the)o(y)d(can)105
4683 y(e)o(xist)30 b(at)i(v)o(ery)f(lo)n(w)f(le)n(v)o(els)g(of)i(the)f
(operating)g(sys-)105 4803 y(tems,)26 b(sensors)f(also)g(ha)n(v)o(e)h
(the)g(possibility)d(of)j(dis-)105 4924 y(rupting)18
b(operations)g(that)h(depend)g(on)g(precise)g(tim-)105
5044 y(ing.)7 5279 y Fi(\017)48 b Fl(The)o(y)18 b(are)i(dif)n(\002cult)
e(to)h(port)f(to)h(dif)n(ferent)f(operating)105 5399
y(systems.)1992 137 y Fm(3)143 b(Embedded)99 b(sensors)h(f)l(or)h(de-)
2207 319 y(tecting)34 b(netw)o(ork)f(attacks)1992 545
y Fl(W)-8 b(e)22 b(ha)n(v)o(e)g(implemented)f(a)h(number)g(of)g
(embedded)g(sen-)1992 665 y(sors)e(for)h(detecting)f(common)f(netw)o
(ork)h(attacks.)29 b(In)21 b(this)1992 786 y(section)38
b(we)h(describe)f(this)g(implementation)f(and)h(the)1992
906 y(results)24 b(obtained.)1992 1208 y Fh(3.1)119 b(Implementation)29
b(platf)m(orm)1992 1398 y Fl(The)76 b(sensors)f(ha)n(v)o(e)h(been)h
(implemented)d(in)i(the)1992 1518 y(OpenBSD)38 b(2.6)f(operating)g
(system)f([18,)k(24],)h(one)c(of)1992 1638 y(the)23 b(three)h(main)g(v)
n(ariations)e(of)i(the)g(free)g(operating)g(sys-)1992
1759 y(tems)29 b(based)h(on)f(the)h(BSD)h(distrib)n(ution.)44
b(This)29 b(operat-)1992 1879 y(ing)24 b(system)f(w)o(as)i(chosen)g
(for)g(the)g(follo)n(wing)d(reasons:)2088 2115 y Fi(\017)49
b Fl(The)42 b(source)g(code)g(is)f(a)n(v)n(ailable,)46
b(which)41 b(mak)o(es)2187 2235 y(it)33 b(easy)i(to)f(instrument)f(the)
h(sensors)g(both)f(in)h(the)2187 2355 y(k)o(ernel)39
b(and)g(in)f(the)h(system)f(programs.)72 b(Exten-)2187
2476 y(si)n(v)o(e)18 b(documentation)g(is)i(a)n(v)n(ailable)f([18,)i
(35)o(])g(about)2187 2596 y(the)27 b(internals)g(of)h(the)g(k)o(ernel)f
(and)h(its)f(netw)o(orking)2187 2717 y(code.)2088 2925
y Fi(\017)49 b Fl(The)24 b(source)g(tree)h(is)f(centrally)g(managed)g
(and)h(dis-)2187 3046 y(trib)n(uted)c(as)i(a)g(single)e(directory)h
(tree.)31 b(This)21 b(mak)o(es)2187 3166 y(it)k(more)h(manageable)f
(than)h(Linux,)f(for)h(e)o(xample,)2187 3286 y(where)35
b(source)g(code)f(for)h(dif)n(ferent)g(components)2187
3407 y(of)21 b(the)g(operating)g(system)g(are)h(distrib)n(uted)e(as)h
(sep-)2187 3527 y(arate)26 b(packages.)34 b(The)26 b(source)f(tree)i
(of)e(OpenBSD)2187 3647 y(closely)20 b(mimics)g(the)i(layout)f(of)g
(the)g(system)g(itself,)2187 3768 y(making)h(it)h(easy)h(to)g(locate)f
(the)h(code)g(for)f(dif)n(ferent)2187 3888 y(programs)h(and)h
(subsystems.)2088 4097 y Fi(\017)49 b Fl(The)27 b(OpenBSD)g(project)g
(is)g(kno)n(wn)f(for)h(its)f(atten-)2187 4217 y(tion)35
b(to)h(security)-6 b(,)39 b(and)d(is)g(the)h(\002rst)g(widely)e(used)
2187 4337 y(operating)44 b(system)g(that)g(has)h(gone)g(through)f(an)
2187 4458 y(e)o(xtensi)n(v)o(e)30 b(line-by-line)h(security)h(audit)f
(process.)2187 4578 y(Most)24 b(of)i(the)g(security)g(problems)e(for)j
(which)e(sen-)2187 4699 y(sors)34 b(will)f(be)i(implemented)e(ha)n(v)o
(e)h(already)h(been)2187 4819 y(\002x)o(ed)j(in)g(OpenBSD.)h(By)f
(looking)f(at)i(the)f(secu-)2187 4939 y(rity)h(patches)h(and)g(at)g
(the)g(change)g(log)f(for)h(each)2187 5060 y(\002le)32
b(it)f(is)g(easier)i(to)e(locate)h(the)g(portions)e(of)i(code)2187
5180 y(where)23 b(the)g(problems)f(e)o(xisted.)29 b(This)23
b(helps)f(in)h(de-)2187 5301 y(termining)38 b(where)i(the)f(sensors)g
(for)h(each)g(intru-)2187 5421 y(sion)24 b(ha)n(v)o(e)h(to)f(be)h
(placed.)32 b(In)25 b(f)o(act,)g(in)g(man)o(y)f(cases)1925
5670 y(5)p eop
%%Page: 6 6
6 5 bop 105 137 a Fl(the)27 b(code)g(that)g(\002x)o(ed)g(the)f(problem)
g(could)h(be)g(eas-)105 257 y(ily)j(identi\002ed,)i(and)f(the)f(only)g
(thing)g(that)g(needed)105 378 y(to)22 b(be)h(done)g(w)o(as)g(adding)f
(the)g(code)h(for)h(producing)105 498 y(a)31 b(noti\002cation.)47
b(Finally)-6 b(,)30 b(because)h(the)g(problems)105 618
y(themselv)o(es)f(no)h(longer)g(e)o(xist,)h(it)f(is)g(easier)h(to)f
(try)105 739 y(attacks)23 b(against)f(the)h(instrumented)e(system)h
(with-)105 859 y(out)38 b(w)o(orrying)g(about)g(the)h(adv)o(erse)g(ef)n
(fects)f(the)o(y)105 980 y(could)24 b(ha)n(v)o(e)h(on)f(the)h(system.)7
1188 y Fi(\017)48 b Fl(It)63 b(runs)f(on)g(multiple)f(architectures,)72
b(includ-)105 1308 y(ing)35 b(lo)n(w-end)f(Intel)h(and)g(Sparc)i
(systems,)f(which)105 1428 y(mak)o(es)29 b(it)f(easier)i(to)e(set)h(up)
g(a)g(netw)o(ork)f(of)h(instru-)105 1549 y(mented)24
b(systems)g(for)h(e)o(xperimentation.)-90 1850 y Fh(3.2)119
b(Sour)n(ces)30 b(of)g(inf)m(ormation)-90 2039 y Fl(The)g(sensors)f
(implemented)e(were)k(mapped)e(to)g(entries)-90 2160
y(in)37 b(the)g(CVE)g(\(Common)g(V)-7 b(ulnerabilities)35
b(and)i(Expo-)-90 2280 y(sures\))31 b(database)h([7,)h(20].)51
b(The)31 b(CVE)h(is)f(not)g(a)h(taxon-)-90 2400 y(omy)i(or)h(a)f
(classi\002cation)g(scheme,)j(and)e(is)f(used)g(only)-90
2521 y(as)c(a)f(f)o(airly)h(complete)f(and)g(recognized)h(list)e(of)i
(kno)n(wn)-90 2641 y(vulnerabilities)22 b(and)j(attacks.)30
b(Linking)23 b(each)i(sensor)f(to)-90 2762 y(a)35 b(CVE)g(entry)g(f)o
(acilitates)f(discussion)f(and)i(reference,)-90 2882
y(and)42 b(ensures)g(that)f(no)h(repeated)g(sensors)g(are)g(imple-)-90
3002 y(mented.)52 b(F)o(or)32 b(the)g(w)o(ork)g(reported)h(in)e(this)h
(document,)-90 3123 y(v)o(ersion)24 b(20000118)f(of)i(the)g(database)g
(w)o(as)f(used.)8 3244 y(Information)43 b(about)h(the)h(attacks)f
(themselv)o(es,)k(in-)-90 3364 y(cluding)32 b(e)o(xploits,)h(w)o(as)g
(gathered)f(from)h(the)g(common)-90 3485 y(sources)25
b(on)f(the)h(Internet)g([5,)f(25,)h(29)o(,)g(32,)g(37)o(].)8
3606 y(As)k(a)h(special)g(case,)h(sensors)e(for)h(dif)n(ferent)g(v)n
(ariants)-90 3726 y(of)47 b(port)f(scanning)g([13])h(were)g
(implemented.)94 b(Port)-90 3847 y(scans)43 b(are)h(not)f(considered)f
(attacks)h(by)g(themselv)o(es,)-90 3967 y(b)n(ut)38 b(are)i(commonly)d
(a)i(prelude)g(to)g(an)g(attack,)j(there-)-90 4088 y(fore)28
b(useful)f(to)h(detect.)39 b(Port)28 b(scans)f(do)h(not)f(ha)n(v)o(e)g
(CVE)-90 4208 y(numbers.)-90 4509 y Fh(3.3)119 b(Logging)29
b(mechanisms)-90 4699 y Fl(The)47 b(sensors)f(as)h(reported)f(in)g
(this)g(document)g(were)-90 4819 y(concerned)i(more)g(with)g
(correctness)g(than)f(with)h(the)-90 4939 y(mechanism)25
b(used)h(for)h(logging)d(their)i(results.)34 b(F)o(or)27
b(this)-90 5060 y(reason,)43 b(these)d(sensors)f(use)h(simple)e
Ff(printf)h Fl(state-)-90 5180 y(ments)e(to)g(produce)g(reports.)68
b(W)l(ithin)37 b(the)g(OpenBSD)-90 5301 y(k)o(ernel,)25
b(these)g(statements)f(result)g(in)h(the)g(messages)f(be-)-90
5421 y(ing)g(printed)g(to)g(the)g(system)g(console)g(and)g(stored)h(in)
f(the)1992 137 y(system)18 b(message)g(b)n(uf)n(fer)i(\(also)f
(accessible)g(through)f(the)1992 257 y(standard)24 b
Fc(dmesg)h Fl(command\).)2089 422 y(Ho)n(we)n(v)o(er)l(,)h(w)o(ork)h
(is)g(also)g(underw)o(ay)g(to)g(pro)o(vide)f(ap-)1992
543 y(propriate)j(logging)g(mechanisms)f(for)j(embedded)e(sen-)1992
663 y(sors.)51 b(W)-8 b(e)33 b(are)f(w)o(orking)g(on)f(determining)g
(which)h(log-)1992 783 y(ging)22 b(techniques)g(are)i(more)e
(appropriate)h(for)g(the)g(kinds)1992 904 y(of)d(information)e
(generated)j(by)f(the)f(sensors)h(and)g(for)g(the)1992
1024 y(w)o(ays)25 b(in)h(which)f(that)h(information)e(is)i(used.)33
b(As)26 b(of)g(this)1992 1144 y(writing,)c(a)j(\002rst)e
(implementation)f(of)i(a)g(sensor)n(-speci\002c)1992
1265 y(logging)19 b(mechanism)h(has)g(been)h(\002nished,)h(and)e(the)h
(sen-)1992 1385 y(sors)26 b(are)i(being)e(modi\002ed)h(to)f(use)h(that)
f(mechanism)g(in-)1992 1506 y(stead)e(of)h(the)g(standard)f
Ff(printf)g Fl(call.)1992 2086 y Fh(3.4)119 b(Sensors)29
b(implemented)1992 2367 y Fl(In)35 b(this)f(section)h(we)g(describe)h
(the)f(attacks)g(for)h(which)1992 2487 y(sensors)27 b(ha)n(v)o(e)i
(been)g(implemented,)e(and)i(comment)e(on)1992 2608 y(some)i
(speci\002c)h(issues)f(about)g(each)h(one)g(of)f(them.)45
b(F)o(or)1992 2728 y(each)28 b(attack,)g(its)e(CVE)i(number)f(is)g
(mentioned,)g(and)g(in)1992 2848 y(most)j(cases,)j(the)f(section)e(of)i
(code)g(in)f(which)g(the)g(sen-)1992 2969 y(sor)26 b(w)o(as)h
(implemented)e(is)i(sho)n(wn)e(\(in)i(man)o(y)f(cases)h(the)1992
3089 y(code)36 b(has)h(been)f(reformatted)h(for)g(space\).)66
b(Thus,)39 b(we)1992 3209 y(can)31 b(see)g(that)f(most)g(sensors)h(are)
g(v)o(ery)g(short)f(and)h(sim-)1992 3330 y(ple,)h(yet)f(the)o(y)g(pro)o
(vide)f(v)o(ery)h(adv)n(anced)g(detection)f(ca-)1992
3450 y(pabilities)23 b(\(as)i(sho)n(wn)e(in)i(Section)g(3.5\).)2089
3615 y(The)43 b(added)g(or)f(modi\002ed)g(lines)g(ha)n(v)o(e)h(been)g
(high-)1992 3736 y(lighted)27 b(in)g(each)i(code)g(section.)40
b(All)28 b(the)g(sensors)f(ha)n(v)o(e)1992 3856 y(been)f(wrapped)h(in)f
Ff(#ifdef)f Fl(directi)n(v)o(es)g(and)i(in)f(an)g Ff(if)1992
3976 y Fl(clause,)34 b(so)f(that)f(the)o(y)g(can)h(be)g(disabled)f
(both)g(at)h(com-)1992 4097 y(pile)45 b(time)f(and)i(at)g(run)f(time.)
92 b(W)-8 b(e)46 b(are)g(in)g(the)f(pro-)1992 4217 y(cess)35
b(of)h(inte)o(grating)e(the)i(run-time)f(control)g(v)n(ariables)1992
4337 y(to)i(the)h(k)o(ernel)g(parameters)g(mechanism)e(a)n(v)n(ailable)
h(in)1992 4458 y(OpenBSD,)23 b(through)f(which)h(some)f(k)o(ernel)h
(parameters)1992 4578 y(can)g(be)f(modi\002ed)g(at)h(run)g(time)f
(without)f(the)h(need)h(to)f(re-)1992 4699 y(compile)j(the)i(k)o
(ernel.)37 b(The)27 b(ability)f(to)g(disable)g(the)h(sen-)1992
4819 y(sors)33 b(at)g(runtime)g(may)g(not)g(be)h(completely)e
(desirable,)1992 4939 y(as)23 b(it)f(of)n(fers)h(the)g(possibility)e
(for)i(an)g(attack)o(er)h(to)f(disable)1992 5060 y(the)g(sensors)h(if)g
(he)g(manages)g(to)g(obtain)f(suf)n(\002cient)h(pri)n(v-)1992
5180 y(ile)o(ges)31 b(in)h(the)g(system.)52 b(F)o(or)32
b(the)g(purposes)g(of)g(testing,)1992 5301 y(ho)n(we)n(v)o(er)l(,)f
(the)h(capability)e(of)i(enabling)e(and)i(disabling)1992
5421 y(sensors)24 b(at)h(runtime)e(is)i(necessary)-6
b(.)1925 5670 y(6)p eop
%%Page: 7 7
7 6 bop -90 137 a Fc(3.4.1)99 b(Land)26 b(\(CVE-1999-0016\))-90
352 y Fl(This)42 b(attack)g(consists)f(of)h(a)h(TCP)g(SYN)g(pack)o(et)f
(sent)-90 473 y(to)31 b(an)h(open)f(port)g(on)g(the)g(attack)o(ed)h
(machine)f(with)g(the)-90 593 y(source)i(IP)g(address)g(and)f(port)g
(set)h(to)f(the)h(same)f(as)h(the)-90 713 y(destination.)73
b(On)40 b(a)g(vulnerable)f(machine,)k(this)38 b(puts)-90
834 y(the)23 b(k)o(ernel)f(into)g(an)h(in\002nite)f(loop)g(sending)g(A)
l(CK)h(pack-)-90 954 y(ets)41 b(to)g(itself)g(in)g(a)h(interrupt)f(le)n
(v)o(el)f(that)h(pre)n(v)o(ents)f(all)-90 1074 y(user)g(processes)g
(from)f(running,)k(ef)n(fecti)n(v)o(ely)c(locking)-90
1195 y(the)25 b(machine.)8 1321 y(OpenBSD)k(2.6)f(\002lters)h(those)f
(pack)o(ets)g(shortly)g(after)-90 1434 y(the)o(y)35 b(ha)n(v)o(e)h
(entered)g(the)g(system)f(while)g(the)h(sock)o(et)g(is)-90
1547 y(still)27 b(in)i(state)f(LISTEN.)h(The)g(sensor)f(has)h(been)f
(placed)-90 1660 y(there,)d(right)f(before)h(the)g(pack)o(et)g(is)f
(dropped.)-90 1936 y Fd(case)53 b(TCPS_LISTEN:)c Fb(f)-90
2049 y Fd(...)19 2162 y(if)54 b(\(ti->ti_dst.s_)o(ad)o(dr)48
b(==)237 2275 y(ti->ti_src.s_ad)o(dr\))g Fb(f)183 2387
y Fa(/*)53 b(ESP)h(*/)-90 2500 y(#ifdef)e(ESP_LAND)183
2613 y(if)h(\(esp.sensors.lan)o(d\))346 2726 y(printf\("LAND)c(attack)p
Fb(n)p Fa(n"\);)-90 2839 y(#endif)346 2952 y Fd(goto)k(drop;)183
3065 y Fb(g)-90 3178 y Fd(...)g Fb(g)-90 3529 y Fc(3.4.2)99
b(T)-9 b(eardr)n(op)26 b(\(CVE-1999-0052\))-90 3745 y
Fl(This)39 b(attack)h(consists)f(of)h(tw)o(o)g(o)o(v)o(erlapping)e(IP)j
(frag-)-90 3865 y(ments.)84 b(The)43 b(\002rst)g(is)f(a)h(lar)n(ge)g
(fragment,)k(while)c(the)-90 3985 y(second)26 b(fragment)g(is)g(short)f
(and)i(\223\002ts\224)f(within)f(the)h(\002rst)-90 4106
y(fragment)j(\(it)f(starts)g(at)h(a)g(later)g(of)n(fset)f(b)n(ut)h
(ends)f(before)-90 4226 y(the)33 b(\002rst)g(fragment\).)54
b(The)33 b(IP)h(reassembly)e(routine)g(in)-90 4347 y(vulnerable)f
(systems)f(gets)h(confused)g(by)g(the)g(con\003ict-)-90
4467 y(ing)41 b(of)n(fsets)g(and)h(tries)g(to)f(allocate)h(memory)f
(for)h(the)-90 4587 y(ne)n(w)22 b(data)h(using)e(a)i(ne)o(gati)n(v)o(e)
d(v)n(alue,)i(which)g(crashes)h(the)-90 4708 y(system.)53
b(There)33 b(are)g(multiple)e(deri)n(v)n(ati)n(v)o(es)f(of)j(this)e
(at-)-90 4828 y(tack)37 b(that)g(e)o(xploit)f(v)n(arious)g(\002x)o(es,)
k(de)n(vices)d(and)g(en)l(vi-)-90 4948 y(ronments.)62
b(One)36 b(of)f(those)g(will)g(be)h(discussed)f(in)g(the)-90
5069 y(ne)o(xt)24 b(section.)8 5195 y(In)d(OpenBSD)g(2.6)g(a)g(special)
g(check)g(for)g(this)f(w)o(as)h(put)-90 5308 y(in)i(the)h(reassembly)f
(code.)31 b(Again)23 b(the)g(sensor)h(has)f(been)-90
5421 y(placed)i(there.)1992 137 y Fd(i)54 b(=)g(p->ipqe_ip->ip)o(_o)o
(ff)48 b(+)2210 250 y(p->ipqe_ip->ip)o(_l)o(en)g(-)2210
363 y(ipqe->ipqe_ip-)o(>i)o(p_o)o(ff)o(;)1992 476 y(if)53
b(\(i)h(>)g(0\))g Fb(f)2101 588 y Fd(if)f(\(i)h(>=)g(ipqe->ipqe_ip-)o
(>i)o(p_)o(le)o(n\))48 b Fb(f)2264 701 y Fa(/*)54 b(ESP)f(*/)1992
814 y(#ifdef)e(ESP_TEARDROP)2264 927 y(if)j(\(esp.sensors.te)o(ar)o(dr)
o(op)o(\))48 b Fb(f)2428 1040 y Fa(printf\("TEARDRO)o(P)g(attack)p
Fb(n)p Fa(n"\);)2428 1153 y(...)2264 1266 y Fb(g)1992
1379 y Fa(#endif)2210 1492 y Fd(goto)k(dropfrag;)2101
1605 y Fb(g)1992 1901 y Fc(3.4.3)98 b(PIX)25 b(DoS)g(\(CVE-1999-0157\))
1992 2091 y Fl(This)f(e)o(xploits)g(the)i(same)f(b)n(ug)h(as)g(T)-7
b(eardrop,)26 b(b)n(ut)f(it)g(w)o(as)1992 2204 y(de)n(v)o(eloped)k
(speci\002cally)i(for)h(the)f(Cisco)g(PIX)h(\002re)n(w)o(all,)1992
2317 y(which)46 b(does)h(not)f(\002lter)i(fragments)e(with)g(of)n(fset)
h(not)1992 2430 y(equal)33 b(to)g(zero.)57 b(A)33 b(special)g(sensor)g
(for)h(this)f(has)g(been)1992 2543 y(placed)24 b(at)h(the)g(dots)f(in)g
(the)h(pre)n(vious)e(code)i(se)o(gment.)1992 2768 y Fa(if)53
b(\(p->ipqe_ip->ip)o(_o)o(ff)48 b(>)54 b(0\))2101 2880
y(printf\("PIX)49 b(flavored)p Fb(n)p Fa(n"\);)1992 3177
y Fc(3.4.4)98 b(TCP)26 b(RST)f(DoS)g(\(CVE-1999-0053\))1992
3367 y Fl(This)35 b(attack)h(sends)g(a)h(for)n(ged)f(TCP)i(RST)f(pack)o
(et)f(and)1992 3480 y(disconnects)18 b(an)h(established)f(TCP)i
(connection,)f(whose)1992 3593 y(port)31 b(numbers)g(the)g(attack)o(er)
i(kno)n(ws)d(or)i(guesses)f([12].)1992 3706 y(V)-7 b(ulnerable)26
b(TCP)i(stacks)f(do)g(not)f(check)i(the)f(sequence)1992
3819 y(number)32 b(of)h(the)g(RST)h(pack)o(et)f(and)g(reset)g(a)g(v)n
(alid)f(con-)1992 3932 y(nection.)87 b(The)44 b(sensor)g(is)f(placed)h
(in)g(the)f(check)i(for)1992 4045 y(the)31 b(attack)g(that)g(already)h
(e)o(xists)e(in)h(the)h(code)g(for)f(RST)1992 4157 y(pack)o(et)24
b(handling.)1992 4382 y Fd(if)53 b(\(tiflags)e(&)j(TH_RST\))e
Fb(f)2101 4495 y Fd(if\(ti->ti_seq!)o(=t)o(p-)o(>la)o(st)o(_a)o(ck)o
(_s)o(ent)o(\))p Fb(f)2210 4608 y Fa(/*)h(ESP)h(*/)1992
4721 y(#ifdef)d(ESP_RSTDOS)2210 4834 y(if)i(\(esp.sensors.rst)o(do)o
(s\))2373 4947 y(printf\("TCP)d(RST)j(DOS)g(attack)p
Fb(n)p Fa(n"\);)1992 5059 y(#endif)2210 5172 y Fd(goto)f(drop;)2101
5285 y Fb(g)2101 5398 y Fd(...)h Fb(g)1925 5670 y Fl(7)p
eop
%%Page: 8 8
8 7 bop -90 137 a Fc(3.4.5)99 b(Ping)25 b(of)f(Death)i
(\(CVE-1999-0128\))-90 329 y Fl(The)j(ping)f(of)h(death)g(is)f(a)i
(fragmented)e(ICMP)i(echo)f(re-)-90 442 y(quest)c(whose)g(reassembled)g
(length)f(is)h(longer)g(than)g(the)-90 555 y(maximum)30
b(length)g(of)i(an)f(IP)i(pack)o(et.)50 b(This)31 b(is)g(a)h(com-)-90
668 y(parati)n(v)o(ely)43 b(old)i(vulnerability)-6 b(,)47
b(therefore)f(a)f(detailed)-90 781 y(description)27 b(is)h(omitted)f
(here.)42 b(OpenBSD)28 b(2.6)g(checks)-90 894 y(for)20
b(this)f(vulnerability)f(and)h(the)h(sensor)f(is)h(placed)f(there.)-90
1125 y Fd(if)54 b(\(\(next+\(ip->ip)o(_h)o(l<)o(<2\))o(\))183
1238 y(>)g(IP_MAXPACKET\))48 b Fb(f)19 1351 y Fa(/*)54
b(ESP)f(*/)-90 1464 y(#ifdef)f(ESP_PINGOFDEAT)o(H)19
1577 y(if)i(\(esp.sensors.p)o(in)o(gof)o(de)o(at)o(h)48
b(&&)237 1690 y(ip->ip_p)j(==)j(IPPROTO_ICMP\))128 1803
y(printf\("PING'O')o(DE)o(ATH)48 b(attack)p Fb(n)p Fa(n"\);)-90
1915 y(#endif)19 2028 y Fd(...)53 b Fb(g)-90 2332 y Fc(3.4.6)99
b(NetBSD)62 b(TCP)f(Race)g(Condition)h(\(CVE-)209 2453
y(1999-0396\))-90 2652 y Fl(This)34 b(attack)h(stalls)e(a)j(blocking)d
(serv)o(er)i(by)f(deleting)g(a)-90 2773 y(sock)o(et)25
b(after)h(it)e(is)h(seen)g(by)g(the)g(serv)o(er)l(,)g(b)n(ut)g(before)g
(it)g(is)-90 2893 y(accepted)35 b([22].)59 b(The)35 b(attack)o(er)g
(completes)e(the)h(three-)-90 3014 y(w)o(ay)22 b(handshak)o(e)g(and)g
(then)f(immediately)g(disconnects.)-90 3134 y(The)28
b(advisory)f([22])h(mentions)e(using)h(RST)h(pack)o(ets)g(to)-90
3254 y(remo)o(v)o(e)h(the)h(sock)o(et,)h(b)n(ut)e(FIN)i(pack)o(ets)f
(could)g(also)f(be)-90 3375 y(used,)21 b(as)g(in)g(a)g(f)o(ast)f(port)h
(scanner)g(lik)o(e)f Fc(nmap)i Fl([13].)29 b(This)-90
3495 y(attack)36 b(has)g(to)g(be)g(completed)f(between)i(the)f(a)o(w)o
(ak)o(en-)-90 3615 y(ing)27 b(of)g(the)g(serv)o(er)h(after)g(the)f
(handshak)o(e)g(and)g(before)h(it)-90 3736 y(calls)e(the)g
Ff(accept)f Fl(function)g(on)h(the)g(ne)n(w)f(sock)o(et.)35
b(An)-90 3856 y(attack)o(er)26 b(w)o(ould)e(most)g(lik)o(ely)h(need)g
(more)g(than)g(one)g(at-)-90 3977 y(tempt)i(to)h(achie)n(v)o(e)f(this.)
39 b(It)28 b(w)o(ould)f(also)h(be)g(tar)n(geted)g(to)-90
4097 y(one)36 b(speci\002c)h(TCP)f(serv)o(er)g(port.)65
b(If)36 b(both)f(conditions)-90 4217 y(are)23 b(true,)g(the)f(sensor)g
(that)g(also)g(detects)g(port)g(scans)g(will)-90 4338
y(classify)29 b(this)g(as)h(a)g(race)h(attack.)46 b(FIN)31
b(and)f(RST)g(pack-)-90 4458 y(ets)37 b(with)g(the)g(initial)f
(sequence)h(number)g(plus)g(one)g(in)-90 4579 y(the)32
b(established)g(state)g(are)h(reported)g(to)f(the)g(port)g(scan)-90
4699 y(detector)l(,)25 b(which)f(is)g(discussed)g(in)h(a)g(Section)g
(3.4.15.)-90 5003 y Fc(3.4.7)99 b(Linux)26 b(Blind)f(Spoo\002ng)h
(\(CVE-1999-0414\))-90 5195 y Fl(Some)32 b(v)o(ersions)e(of)i(the)f
(Linux)g(TCP)h(implementation)-90 5308 y(are)50 b(vulnerable)e(to)h
(spoo\002ng)f(of)h(TCP)h(connections)-90 5421 y(without)22
b(completing)f(the)i(three-w)o(ay)h(handshak)o(e)f([23)o(].)1992
137 y(The)29 b(attack)o(er)g(does)g(not)f(need)h(to)g(guess)f(the)h
(initial)f(se-)1992 250 y(quence)39 b(number)h(and)f(can)h(spoof)g
(connections)e(from)1992 363 y(addresses)i(whose)h(connections)f
(remain)g(\223in)l(visible.)-7 b(\224)1992 476 y(The)19
b(sequence)h(of)f(pack)o(ets)h(for)f(the)h(attack)f(is:)27
b(one)20 b(SYN)1992 588 y(pack)o(et,)25 b(then)g(possibly)e(multiple)h
(pack)o(ets,)h(all)g(without)1992 701 y(A)l(CK)j(\003ag,)i(and)f
(\002nally)f(one)g(FIN)i(pack)o(et)e(without)f(the)1992
814 y(A)l(CK)e(\003ag,)h(or)f(one)g(pack)o(et)g(with)f(FIN)i(and)f(all)
g(the)g(pay-)1992 927 y(load)g(data.)32 b(Although)24
b(the)i(connection)e(remains)h(in)g(the)1992 1040 y(SYN)p
2197 1040 30 4 v 36 w(RECEIVED)f(state,)g(the)g(FIN)h(pack)o(et)f(will)
g(cause)1992 1153 y(the)19 b(deli)n(v)o(ery)g(of)h(queued)f(data)h(to)g
(the)f(sock)o(et)h(and)g(its)f(ap-)1992 1266 y(plication.)37
b(OpenBSD)29 b(2.6)e(ignores)g(the)g(data)h(of)g(pack-)1992
1379 y(ets)39 b(without)f(the)h(A)l(CK)g(\003ag.)75 b(The)40
b(sensor)f(raises)g(an)1992 1492 y(alarm)18 b(on)h(FIN)h(pack)o(ets)f
(without)e(A)l(CK)i(\003ag)h(in)f(the)f(state)1992 1605
y(SYN)p 2197 1605 V 36 w(RECEIVED.)1992 1849 y Fd(case)52
b(TCPS_SYN_RECEIV)o(ED:)2101 1962 y(if)h(\(tiflags)e(&)j(TH_ACK\))e
Fb(f)2210 2075 y Fd(...)2101 2188 y Fb(g)j Fd(else)d
Fb(f)2210 2301 y Fa(/*)h(ESP)h(*/)1992 2414 y(#ifdef)d(ESP_BLINDSPOOF)
2210 2527 y(if)i(\(esp.sensors.bli)o(nd)o(sp)o(oo)o(f\))48
b Fb(f)2319 2640 y Fa(if)53 b(\(tiflags)e(&)j(TH_FIN\))2428
2753 y(printf\("BLIND)49 b(SPOOF)j(attack)p Fb(n)p Fa(n"\);)2210
2865 y Fb(g)1992 2978 y Fa(#endif)2101 3091 y Fb(g)1992
3409 y Fc(3.4.8)98 b(W)n(in)25 b(Nuk)o(e)h(\(CVE-1999-0153\))1992
3614 y Fl(This)18 b(attack)h(sends)g(out-of-band)g(data)g(to)g(TCP)i
(port)e(139)1992 3734 y(\()p Fc(netbios-ssn)p Fl(\).)35
b(Most)26 b(vulnerable)f(systems)g(\(although)1992 3855
y(this)31 b(is)g(a)i(W)l(indo)n(ws-speci\002c)e(attack,)j(other)e
(products,)1992 3975 y(such)h(as)g(SCO)h(OpenServ)o(er)l(,)i(ha)n(v)o
(e)d(sho)n(wn)f(to)h(be)h(vul-)1992 4095 y(nerable)j(as)f(well\))h
(crash.)67 b(This)36 b(attack)h(can)g(only)f(oc-)1992
4216 y(cur)20 b(if)g(the)h(TCP)g(three-w)o(ay)g(handshak)o(e)f(has)g
(been)g(com-)1992 4336 y(pleted)27 b(successfully)-6
b(.)38 b(Therefore,)29 b(the)e(attack)h(requires)1992
4457 y(a)33 b(serv)o(er)g(listening)e(on)i(that)f(port.)55
b(In)33 b(UNIX)g(systems)1992 4577 y(this)23 b(serv)o(er)i(could)f(be)h
(SAMB)m(A)g([30].)2089 4705 y(In)32 b(our)f(model,)h(it)f(w)o(ould)f
(ha)n(v)o(e)i(been)f(preferable)h(to)1992 4826 y(place)23
b(the)f(sensor)h(in)f(the)h(code)g(of)g(the)f(SAMB)m(A)h(serv)o(er)l(,)
1992 4946 y(because)30 b(this)f(attack)i(is)f(speci\002c)g(to)g(that)g
(service.)47 b(F)o(or)1992 5067 y(the)19 b(purposes)h(of)g(this)f
(study)-6 b(,)19 b(a)h(sensor)g(has)g(been)g(placed)1992
5187 y(in)k(the)h(k)o(ernel.)2089 5308 y(This)g(case)h(e)o(x)o
(empli\002es)e(one)i(of)f(the)h(big)f(adv)n(antages)1992
5421 y(of)37 b(embedded)g(sensors:)55 b(although)36 b(the)h
(vulnerability)1925 5670 y(8)p eop
%%Page: 9 9
9 8 bop -90 137 a Fl(does)31 b(not)g(occur)h(in)g(OpenBSD,)g(a)g
(sensor)f(can)h(be)g(im-)-90 250 y(plemented)24 b(to)g(detect)h(the)g
(attack.)-90 434 y Fd(/*)54 b(TCP)f(input)f(routine)f(*/)-90
547 y(...)-90 660 y Fa(/*)j(ESP)f(*/)-90 773 y(#ifdef)f(ESP_WINNUKE)-90
886 y(if)i(\(esp.sensors.w)o(in)o(nu)o(ke\))48 b Fb(f)19
999 y Fa(if)54 b(\(\(ntohs\(th->th)o(_d)o(por)o(t\))48
b(==)53 b(139\))237 1112 y(&&)h(\(th->th_urp\)\))128
1225 y(printf\("WINNUKE)48 b(attack)p Fb(n)p Fa(n"\);)-90
1338 y Fb(g)-90 1450 y Fa(#endif)-90 1715 y Fc(3.4.9)99
b(Echo-Char)o(gen)25 b(Connections)e(\(CVE-1999-)209
1835 y(0103\))-90 2023 y Fl(This)35 b(attack)g(spoofs)g(pack)o(ets)h
(between)f(tw)o(o)h(attack)o(ed)-90 2143 y(machines)43
b(on)g(the)g Fc(echo)h Fl(or)g Fc(char)o(gen)g Fl(port,)k(respec-)-90
2263 y(ti)n(v)o(ely)-6 b(,)25 b(using)h(UDP)-11 b(.)27
b(Those)g(services)f(are)i(pro)o(vided)e(by)-90 2384
y(the)f Fc(inetd)h Fl(program.)32 b(Therefore,)26 b(the)f(sensors)f
(are)i(best)-90 2504 y(placed)43 b(in)g(that)f(program,)47
b(where)c(the)g(error)h(occurs.)-90 2624 y(The)28 b(code)h(for)g(these)
f(sensors)g(is)g(longer)g(\(with)f(respect)-90 2745 y(to)20
b(the)f(other)h(sensors)f(sho)n(wn\227b)n(ut)f(only)h(25)h(lines)f
(were)-90 2865 y(added)25 b(to)f(the)h Ff(inetd.c)e Fl(\002le\))j(and)e
(not)h(sho)n(wn)e(here.)-90 3129 y Fc(3.4.10)99 b(TCP)86
b(Sequence)i(Number)f(Pr)n(ediction)259 3250 y(\(CVE-1999-0077\))-90
3430 y Fl(If)45 b(the)f(initial)f(TCP)i(sequence)f(number)g(is)g(not)f
(cho-)-90 3543 y(sen)25 b(randomly)-6 b(,)23 b(an)i(attack)o(er)g
(might)e(guess)i(it)f(and)h(com-)-90 3656 y(plete)34
b(the)g(three-w)o(ay)h(handshak)o(e)f(with)f(a)i(spoofed)f(IP)-90
3769 y(address.)77 b(V)-7 b(ulnerable)39 b(implementations)f(use)i(a)g
(pre-)-90 3881 y(dictable)i(algorithm)e(for)j(sequence)f(number)g
(genera-)-90 3994 y(tion.)29 b(OpenBSD)24 b(2.6)e(does)h(not.)29
b(The)23 b(sensor)f(w)o(orks)h(by)-90 4107 y(detecting)37
b(out-of-sequence)g(pack)o(ets)h(with)f(the)g(A)l(CK)-90
4220 y(\003ag)55 b(on)f(sock)o(ets)f(in)h(state)g(SYN)p
1188 4220 30 4 v 36 w(RECEIVED)h(and)-90 4333 y(SYN+A)l(CK)24
b(pack)o(ets)f(in)g(state)f(SYN)p 1227 4333 V 36 w(SENT)-7
b(.)23 b(W)-8 b(e)24 b(sho)n(w)-90 4446 y(the)c(code)h(from)f(SYN)p
680 4446 V 37 w(RECEIVED.)h(The)f(SYN)p 1629 4446 V 36
w(SENT)-90 4559 y(state)25 b(is)f(v)o(ery)g(similar)-5
b(.)-90 4743 y Fd(if)54 b(\(tiflags)d(&)j(TH_ACK\))d
Fb(f)-35 4856 y Fd(...)-35 4969 y(if\(SEQ_LEQ\(th-)o(>t)o(h_)o(ac)o
(k,t)o(p-)o(>s)o(nd)o(_u)o(na\))o(||)128 5082 y(SEQ_GT\(th->th_a)o(ck)o
(,tp)o(->)o(sn)o(d_)o(ma)o(x\)\))o Fb(f)74 5195 y Fa(/*)i(ESP)g(*/)-90
5308 y(#ifdef)f(ESP_TCPSEQNR)74 5421 y(if)h(\(esp.sensors.tc)o(pse)o
(qn)o(r\))2264 137 y(printf\("TCP)d(SEQNOPRED)g(attack)p
Fb(n)p Fa(n"\);)1992 250 y(#endif)2155 363 y Fd(goto)j(dropwithreset;)
1992 476 y Fb(g)i Fd(...)e Fb(g)1992 764 y Fc(3.4.11)98
b(TCP)25 b(SYN)h(Flood)e(\(CVE-1999-0116\))1992 959 y
Fl(The)i(tar)n(get)h(is)f(\003ooded)h(with)f(for)n(ged)h(TCP)h(SYN)f
(pack-)1992 1080 y(ets)19 b(that)g(\002ll)g(the)g(connection)g(table)g
(or)h(e)n(v)o(en)f(main)g(mem-)1992 1200 y(ory)27 b(and)h(cause)g(a)h
(DoS)f(on)f(ne)n(w)h(connections)f(or)h(o)o(v)o(er)n(-)1992
1320 y(load)c(the)h(host,)f(respecti)n(v)o(ely)f([31].)2089
1444 y(OpenBSD)40 b(2.6)f(deals)g(with)g(this)f(attack)h(in)g(a)h(spe-)
1992 1565 y(cial)35 b(subroutine.)61 b(If)35 b(the)h(number)e(of)i
(half-open)f(con-)1992 1685 y(nections)28 b(reaches)i(a)g(certain)g
(limit,)e(e)n(v)o(ery)h(time)g(a)h(ne)n(w)1992 1805 y(connection)20
b(is)h(recei)n(v)o(ed,)h(one)f(of)h(the)f(pending)g(connec-)1992
1926 y(tions)j(in)g(state)h(SYN)p 2726 1926 V 36 w(RECEIVED)h(is)f
(dropped.)31 b(It)25 b(\002rst)1992 2046 y(tries)34 b(to)h(drop)f(a)h
(connection)g(to)f(the)h(same)g(port.)60 b(The)1992 2166
y(sensor)19 b(is)h(placed)g(at)h(the)f(entry)g(of)g(this)f(subroutine.)
28 b(The)1992 2287 y(code)19 b(of)g(the)h(sensor)f(is)f(similar)h(to)g
(other)g(sensors)f(sho)n(wn)1992 2407 y(and)24 b(is)h(omitted)e(here.)
1992 2696 y Fc(3.4.12)98 b(ICMP)60 b(Unr)n(eachable)h(messages)e
(\(CVE-)2340 2816 y(1999-0214\))1992 3011 y Fl(This)34
b(attack)h(sends)f(a)h(for)n(ged)h(ICMP)f(error)h(pack)o(et)f(of)1992
3132 y(type)41 b(unreachable,)k(which)c(has)g(the)h(ef)n(fect)f(of)h
(reset-)1992 3252 y(ting)30 b(an)i(established)e(connection)g(on)i
(vulnerable)f(sys-)1992 3372 y(tems.)j(This)26 b(attack)g(relies)g(on)g
(a)h(combination)e(of)h(\003a)o(ws)1992 3493 y(in)37
b(the)h(design)g(of)g(IP)h(and)f(is)g(therefore)h(hard)f(to)g(pre-)1992
3613 y(v)o(ent)k(and)h(detect.)85 b(ICMP)43 b(pack)o(ets)g(may)g(be)g
(caused)1992 3734 y(by)26 b(the)h(remote)g(host)f(or)h(from)g(an)o(y)g
(gate)n(w)o(ay)f(along)g(the)1992 3854 y(path.)j(The)o(y)22
b(might)g(be)g(generated)h(for)g(se)n(v)o(eral)f(reasons,)1992
3974 y(e)n(v)o(en)30 b(during)g(an)h(established)f(connection,)i(e.g.)
49 b(route)1992 4095 y(changes.)29 b(F)o(or)20 b(protocols)f(using)g
(UDP)h(there)h(is)f(no)f(clear)1992 4215 y(distinction)39
b(between)i(a)g(cle)n(v)o(erly)f(for)n(ged)i(and)f(a)h(real)1992
4335 y(ICMP)20 b(pack)o(et.)30 b(F)o(or)20 b(TCP)h(it)f(is)f(uncommon)g
(that)h(during)1992 4456 y(an)26 b(established)f(session)g(errors)i
(occur)-5 b(.)35 b(OpenBSD)26 b(2.6)1992 4576 y(ignores)38
b(those)g(messages)g(and)h(the)f(sensor)h(is)f(placed)1992
4697 y(there.)1992 4985 y Fc(3.4.13)98 b(ICMP)41 b(Redir)n(ect)i
(messages)e(\(CVE-1999-)2340 5106 y(0265\))1992 5301
y Fl(The)35 b(CVE)h(list)e(indicates)h(that)g(some)g(TCP/IP)i(imple-)
1992 5421 y(mentations,)52 b(especially)c(in)g(embedded)g(controllers,)
1925 5670 y(9)p eop
%%Page: 10 10
10 9 bop -90 137 a Fl(are)34 b(vulnerable)f(to)g(malformed)f(ICMP)i
(redirect)g(mes-)-90 257 y(sages.)116 b(The)53 b(documentation)f(is)h
(confusing)f(about)-90 378 y(those)38 b(malformed)h(pack)o(ets)f(and)h
(the)g(general)g(design)-90 498 y(vulnerability)26 b(of)h(ICMP)h
(redirects.)39 b(T)-7 b(echnical)27 b(details)-90 618
y(about)18 b(the)h(malformed)f(pack)o(et)h(are)h(not)e(published.)28
b(Our)-90 739 y(sensor)45 b(therefore)i(tries)e(to)h(detect)f
(malicious,)50 b(well-)-90 859 y(formed)25 b(redirect)g(messages.)8
976 y(An)38 b(ICMP)h(redirect)f(message)g(that)g(did)f(not)h(origi-)-90
1089 y(nate)29 b(from)g(the)g(current)h(gate)n(w)o(ay)-6
b(,)29 b(or)g(that)g(redirects)g(to)-90 1202 y(a)40 b(gate)n(w)o(ay)g
(on)f(a)i(dif)n(ferent)e(netw)o(ork,)44 b(is)39 b(suspicious.)-90
1315 y(In)47 b(OpenBSD)h(2.6)f(such)g(messages)f(f)o(ail)i(to)e(change)
-90 1427 y(the)34 b(routing)f(tables,)j(and)e(the)g(corresponding)f
(code)h(is)-90 1540 y(where)39 b(the)f(sensor)g(is)g(placed.)72
b(This)37 b(method)h(of)g(de-)-90 1653 y(tection)32 b(has)h(the)g
(unfortunate)f(ef)n(fect)i(that)e(an)h(attack)o(er)-90
1766 y(from)38 b(the)g(local)h(netw)o(ork)f(may)g(still)f(be)i(able)f
(to)g(per)n(-)-90 1879 y(form)22 b(the)g(attack.)29 b(F)o(or)22
b(this)f(reason,)i(and)f(under)g(the)g(rea-)-90 1992
y(soning)j(that)h(ICMP)h(redirect)g(messages)e(are)i(a)g(rare)g(oc-)-90
2105 y(currence,)j(we)f(ha)n(v)o(e)f(also)g(implemented)f(a)i(sensor)f
(that)-90 2218 y(emits)c(an)h(alert)f(on)h(e)n(v)o(ery)f(ICMP)h
(redirect)h(message)e(re-)-90 2331 y(cei)n(v)o(ed.)34
b(This)25 b(sensor)h(can)h(be)f(turned)g(of)n(f)g(if)g(necessary)-6
b(.)-90 2444 y(The)25 b(sensors)f(were)h(placed)g(in)g(the)f(ICMP)i
(layer)-5 b(.)-90 2662 y Fa(/*)54 b(ESP)f(*/)-90 2775
y(#ifdef)f(ESP_ICMPREDIRE)o(CT)-90 2888 y(if)i(\(esp.sensors.r)o(ed)o
(ir)o(ect)o(se)o(ns)o(\))19 3001 y(printf\("REDIREC)o(T)48
b(message)p Fb(n)p Fa(n"\);)-90 3114 y(if)54 b(\(esp.sensors.r)o(ed)o
(ir)o(ect)o(er)o(r\))48 b Fb(f)19 3227 y Fa(struct)k(rtentry)f(*rt;)19
3340 y(rt)j(=)g(rtalloc1\(sinto)o(sa\()o(&i)o(cm)o(ps)o(rc)o(\),0)o
(\);)19 3453 y(if\(rt)e(&&)183 3565 y(ifa_ifwithnet\()o(si)o(nto)o(sa)o
(\(&)o(ic)o(mp)o(dst)o(\)\))346 3678 y(!=)i(rt->rt_ifa\))128
3791 y(printf\("REDIREC)o(T)48 b(attack)p Fb(n)p Fa(n"\);)19
3904 y(else)128 4017 y(if)54 b(\(rt)f(&&)346 4130 y(satosin\(rt->rt_g)o
(at)o(ew)o(ay)o(\))401 4243 y(->sin_addr.s_ad)o(dr)510
4356 y(!=)h(ip->ip_src.s_a)o(dd)o(r\))237 4469 y(printf\("REDIREC)o(T)
49 b(attack)p Fb(n)p Fa(n"\);)-90 4582 y Fb(g)-90 4695
y Fa(#endif)-90 4985 y Fc(3.4.14)99 b(Smurf)26 b(/)e(Fraggle)h
(\(CVE-1999-0513\))-90 5180 y Fl(In)33 b(Smurf)f(the)h(attack)o(ed)g
(host)e(is)h(\003ooded)h(with)f(ICMP)-90 5301 y(echo)42
b(reply)f(pack)o(ets)h(that)f(are)h(generated)g(by)f(for)n(ged)-90
5421 y(ICMP)23 b(echo)f(request)g(pack)o(ets)h(sent)f(to)f(an)i(IP)g
(broadcast)1992 137 y(addresses,)e(appearing)f(to)g(come)g(from)h(the)f
(victim)f(host.)1992 257 y(All)32 b(the)i(hosts)e(in)h(the)g(address)g
(range)h(reply)-6 b(,)35 b(\003ooding)1992 378 y(the)d(tar)n(get.)55
b(One)32 b(pack)o(et)h(from)g(the)f(real)i(attack)o(er)f(can)1992
498 y(cause)i(a)g(\003ood)g(of)g(pack)o(ets)f(to)h(the)f(tar)n(get.)61
b(Therefore)1992 618 y(this)34 b(attack)h(in)l(v)n(olv)o(es)f(tw)o(o)g
(parties:)51 b(the)35 b(re\003ector)i(ad-)1992 739 y(dressed)24
b(by)h(the)g(broadcast)g(pack)o(et)g(and)f(the)h(tar)n(get,)g(the)1992
859 y(spoofed)f(source)h(address.)2089 973 y(OpenBSD)64
b(2.6)f(is)g(con\002gurable)h(to)f(ignore)g(IP)1992 1086
y(broadcast)20 b(echo)h(requests,)g(b)n(ut)f(does)g(not)h(in)f(the)g
(def)o(ault)1992 1199 y(con\002guration,)30 b(because)h(echo)g
(requests)e(to)h(broadcast)1992 1312 y(addresses)24 b(are)i(a)g(v)n
(aluable)e(tool)g(for)h(netw)o(ork)g(manage-)1992 1425
y(ment.)30 b(Ne)n(v)o(ertheless)24 b(one)h(sensor)g(detects)f(those)h
(pack-)1992 1538 y(ets)h(and)h(raises)g(an)h(alarm)f(that)f(this)g
(machine)h(has)g(been)1992 1651 y(used)d(as)h(a)g(re\003ector)h(for)f
(Smurf.)1992 1854 y Fd(case)52 b(ICMP_ECHO:)2101 1967
y(if)h(\(!icmpbmcastech)o(o)c(&&)2319 2080 y(\(m->m_flags&\(M)o(_MC)o
(AS)o(T|)o(M_)o(BC)o(AST)o(\)\))2373 2193 y(!=)54 b(0\))g
Fb(f)2210 2306 y Fa(/*)f(ESP)h(*/)1992 2419 y(#ifdef)d(ESP_SMURF)2210
2531 y(if)i(\(esp.sensors.smu)o(rf)o(_r)o(ef)o(le)o(ct\))2319
2644 y(printf\("SMURF)48 b(as)54 b(reflector)p Fb(n)p
Fa(n"\);)1992 2757 y(#endif)2046 2870 y Fd(...)f Fb(g)2089
3072 y Fl(The)25 b(echo)g(replies)f(arri)n(ving)g(at)h(the)g(\003ooded)
f(host)g(are)1992 3185 y(not)k(structurally)h(distinguishable)e(at)i
(the)h(ICMP)g(layer)1992 3298 y(from)23 b(other)h(echo)f(replies.)30
b(ICMP)25 b(echo)f(replies)f(do)h(not)1992 3411 y(contain)g(a)i
(\002eld)g(for)g(multiple)o(xing)c(the)j(pack)o(et)h(to)f(a)h(lis-)1992
3524 y(tening)j(sock)o(et)i(\(lik)o(e)f(a)h(port)f(number)g(in)h
(UDP\).)g(Ho)n(w-)1992 3637 y(e)n(v)o(er)l(,)22 b(the)h(ping)f(program)
g(\(which)h(is)f(the)g(most)g(frequent)1992 3750 y(cause)27
b(for)g(the)g(generation)g(of)g(echo)g(requests\))g(sets)f(the)1992
3863 y(identi\002cation)k(\002eld)i(in)g(the)g(ICMP)g(pack)o(et)g(to)g
(its)f(pro-)1992 3976 y(cess)40 b(id)f(\(pid\))h(and)g(listens)f(on)h
(a)g(ra)o(w)g(sock)o(et)g(for)g(all)1992 4088 y(ICMP)34
b(traf)n(\002c,)i(reporting)d(replies)h(if)g(the)f(address,)j(se-)1992
4201 y(quence)19 b(number)g(and)g(id)g(\002eld)g(match.)28
b(Our)20 b(sensor)e(uses)1992 4314 y(the)32 b(same)h(method)f(on)g(all)
h(echo)g(replies,)h(by)f(compar)n(-)1992 4427 y(ing)27
b(the)h(ICMP)h(id)f(to)g(the)g(pid)g(of)g(all)g(ra)o(w)g(ICMP)h(sock-)
1992 4540 y(ets)36 b(\(this)h(is)g(done)f(in)h(the)g
Ff(esp)p 3148 4540 30 4 v 35 w(smurf\(\))f Fl(function,)1992
4653 y(not)h(sho)n(wn\).)68 b(If)38 b(no)f(match)h(is)f(found,)j(the)e
(pack)o(et)g(is)1992 4766 y(discarded)26 b(at)i(the)e(ICMP)i(layer)g
(and)f(a)g(counter)g(for)g(un-)1992 4879 y(requested)k(echo)h(replies)g
(is)f(increased.)52 b(If)32 b(a)g(match)g(is)1992 4992
y(found,)23 b(it)g(has)g(to)h(be)g(deli)n(v)o(ered)e(to)h(the)h
(appropriate)f(ra)o(w)1992 5105 y(sock)o(ets)h(and)g(processed)h
(there.)1992 5308 y Fd(case)52 b(ICMP_ECHOREPLY:)2101
5421 y Fa(/*)h(ESP)g(*/)1900 5670 y Fl(10)p eop
%%Page: 11 11
11 10 bop -90 137 a Fa(#ifdef)52 b(ESP_SMURF)19 250 y(if)i
(\(esp.sensors.s)o(mu)o(rf\))48 b Fb(f)128 363 y Fa(if)54
b(\(esp_smurf\(ip,)48 b(icp\)\))237 476 y(goto)53 b(freeit;)128
588 y(goto)g(raw;)19 701 y Fb(g)-90 814 y Fa(#endif)8
1016 y Fl(T)-8 b(o)31 b(mak)o(e)g(this)f(method)h(w)o(ork,)i(the)e
(process)g(ID)h(has)-90 1129 y(to)f(be)g(stored)g(when)g(ICMP)h(ra)o(w)
f(sock)o(ets)f(are)i(created.)-90 1242 y(This)27 b(sho)n(ws)f(another)i
(adv)n(antage)f(of)g(using)g(embedded)-90 1355 y(sensors:)h(additional)
21 b(information)f(can)i(be)g(made)f(a)n(v)n(ail-)-90
1467 y(able)i(when)h(necessary)f(for)h(the)f(purposes)g(of)g
(detection.)-90 1670 y Fd(case)53 b(PRU_ATTACH:)-90 1783
y(...)-90 1896 y Fa(/*)h(ESP)f(*/)-90 2009 y(#ifdef)f(ESP_SMURF)74
2122 y(if)h(\(esp.sensors.sm)o(urf)48 b(&&)292 2235 y(\(\(long\))j
(nam\))i(==)h(IPPROTO_ICMP\))237 2348 y(so->so_pgid)c(=)k
(curproc->p_pid;)-90 2460 y(#endif)8 2669 y Fl(The)33
b(alarm)h(of)g(Smurf)g(pack)o(ets)f(is)h(rate)g(limited.)56
b(A)-90 2790 y(le)o(gitimate)20 b(use)j(of)f Fc(ping)h
Fl(will)e(probably)h(be)g(interrupted)-90 2910 y(when)30
b(there)f(are)i(still)d(echo)i(reply)f(pack)o(ets)h(in)f(the)h(net-)-90
3031 y(w)o(ork)37 b(to)f(be)h(deli)n(v)o(ered)f(to)g(the)h(host.)65
b(Those)37 b(pack)o(ets)-90 3151 y(should)25 b(not)g(raise)i(an)f
(alarm,)g(although)f(the)o(y)g(do)h(match)-90 3271 y(the)i(signature.)
42 b(A)28 b(netw)o(ork)g(layer)h(timer)f(that)g(runs)g(for)-90
3392 y(three)k(seconds)g(e)o(xamines)e(the)i(counter)g(and)g(raises)f
(an)-90 3512 y(alarm)25 b(only)f(if)h(it)f(e)o(xceeds)h(a)g(threshold.)
8 3634 y(A)31 b(deri)n(v)n(ati)n(v)o(e)f(of)i(the)f(Smurf)h(attack)g
(is)f(the)h(Fraggle)-90 3754 y(attack,)j(which)d(is)h(based)g(on)f(the)
h(same)g(principle,)h(b)n(ut)-90 3874 y(uses)k(UDP)g(instead)f(of)h
(ICMP)g(pack)o(ets.)70 b(The)38 b(detec-)-90 3995 y(tion)21
b(of)i(this)e(attack)h(is)g(much)f(harder)i(because)f(there)h(are)-90
4115 y(man)o(y)i(le)o(gitimate)g(UDP)i(services)g(based)f(on)g(IP)h
(broad-)-90 4235 y(casts)32 b(\(e.g.)54 b(BOO)l(TP)-11
b(,)33 b(RIP)g(and)g(NetBIOS\).)g(W)-8 b(e)33 b(ha)n(v)o(e)-90
4356 y(implemented)g(sensors)h(for)h(this)e(attack,)k(b)n(ut)d(the)o(y)
g(are)-90 4476 y(still)23 b(unreliable)i(and)g(in)f(de)n(v)o(elopment.)
-90 4749 y Fc(3.4.15)99 b(P)n(ort)25 b(Scanning)-90 4939
y Fl(Port)40 b(Scanning)h(is)f(a)g(probing)g(technique)f(that)h(sends)
-90 5060 y(pack)o(ets)30 b(to)g(a)h(lar)n(ge)g(number)f(of)g(ports)g
(trying)g(to)g(iden-)-90 5180 y(tify)47 b(the)f(services)h(running)g
(on)f(that)h(machine)g([13)o(].)-90 5301 y(There)21 b(are)g(se)n(v)o
(eral)f(dif)n(ferent)f(pack)o(ets)i(that)f(can)g(be)h(used)-90
5421 y(for)29 b(this.)40 b(A)28 b(short)g(description)f(of)i(them)e
(and)i(the)f(state)1992 137 y(of)38 b(the)f(sock)o(et)h(when)g(those)f
(pack)o(ets)h(arri)n(v)o(e)g(follo)n(ws.)1992 257 y(Those)e(pack)o(ets)
h(are)g(then)g(reported)f(to)h(the)g(port)f(scan)1992
378 y(detector)l(,)41 b(which)d(accumulates)g(them)g(in)g(a)h
(reporting)1992 498 y(routine)j(and)i(prints)e(the)i(summarized)e
(alarm)i(of)f(the)1992 618 y(scan)29 b(in)g(a)h(timer)n(-based)f(alarm)
h(routine.)44 b(Additionally)1992 739 y(to)26 b(these)h(special)f(pack)
o(ets,)h(all)g(TCP)g(pack)o(ets)g(that)g(can-)1992 859
y(not)d(be)h(deli)n(v)o(ered)e(to)i(a)g(sock)o(et)f(are)i(reported.)
1992 1099 y Fc(Full)e(scan:)49 b Fl(The)35 b(attack)o(er)g(completes)f
(the)h(three-w)o(ay)2187 1219 y(handshak)o(e)d(and)i(then)e
(disconnects)h(or)g(reports)g(a)2187 1339 y(connection)42
b(error)-5 b(.)84 b(F)o(or)43 b(the)g(tar)n(get)f(host)g(these)2187
1460 y(are)49 b(either)h(SYN)f(pack)o(ets)g(with)f(no)h(sock)o(et)g(or)
2187 1580 y(FIN/RST)23 b(pack)o(ets)f(in)f(the)h(established)f(state)h
(with)2187 1701 y(the)i(initial)g(sequence)h(number)f(plus)g(one.)1992
1912 y Fc(Half)g(or)h(SYN)g(Scan:)50 b Fl(The)60 b(attack)o(er)i(only)e
(sends)g(a)2187 2032 y(for)n(ged)31 b(SYN)g(pack)o(et)h(and)f(decides)g
(on)f(the)h(reply)2187 2153 y(\(RST)36 b(or)f(SYN+A)l(CK\).)h(If)g(the)
f(port)f(is)h(open)g(an)2187 2273 y(RST)26 b(is)g(sent)f(after)i(the)e
(SYN+A)l(CK.)i(F)o(or)f(the)g(tar)n(-)2187 2393 y(get)38
b(host,)j(these)e(are)g(again)f(SYN)h(pack)o(ets)g(with)2187
2514 y(no)i(sock)o(et)h(or)f(RST)i(pack)o(ets)f(recei)n(v)o(ed)f(in)g
(state)2187 2634 y(SYN)p 2392 2634 30 4 v 36 w(SENT)-7
b(.)1992 2846 y Fc(FIN)24 b(/)h(XMAS)g(/)f(NULL)i(Scans:)50
b Fl(These)d(are)g(pack)o(ets)2187 2966 y(with)38 b(special)i(\003ag)g
(combinations\227)d(FIN:)j(only)2187 3086 y(FIN)23 b(\003ag;)g(XMAS:)g
(FIN+PUSH+URG;)h(NULL:)2187 3207 y(no)j(\003ags.)38 b(These)27
b(pack)o(ets)g(often)g(get)h(dropped)e(on)2187 3327 y(listening)31
b(ports)h(without)f(an)i(RST)h(pack)o(et)f(reply)-6 b(,)2187
3447 y(while)27 b(closed)g(ports)g(do)g(reply)-6 b(.)38
b(OpenBSD)28 b(2.6)g(is)2187 3568 y(vulnerable)f(to)f(this.)38
b(These)27 b(pack)o(ets)g(are)h(seen)f(by)2187 3688 y(the)22
b(tar)n(get)g(host)f(in)h(ports)g(that)f(are)i(in)f(the)g(LISTEN)2187
3809 y(state.)1992 4085 y Fc(3.4.16)98 b(Detecting)26
b(port)g(scans)1992 4276 y Fl(Although)d(UDP-based)j(port)f(scans)g
(are)i(also)e(possible,)1992 4396 y(we)g(ha)n(v)o(e)f(only)h
(implemented)e(detection)h(for)i(TCP)g(port)1992 4517
y(scanning.)78 b(The)41 b(follo)n(wing)e(v)n(ariations)h(of)h(the)g
(tech-)1992 4637 y(niques)24 b(pre)n(viously)f(mentioned)g(e)o(xist:)
2088 4848 y Fi(\017)49 b Fl(FTP)c(bounce)g(scanning)f(does)h(full)f
(TCP)i(scans)2187 4969 y(and)34 b(hides)g(the)h(attack)o(er')-5
b(s)35 b(IP)g(address)g(from)f(the)2187 5089 y(tar)n(get.)2088
5301 y Fi(\017)49 b Fl(Fragmentation)j(scanning)h(may)h(bypass)f(some)
2187 5421 y(pack)o(et)25 b(\002lters)f(on)h(the)g(path.)1900
5670 y(11)p eop
%%Page: 12 12
12 11 bop 7 137 a Fi(\017)48 b Fl(ID)21 b(scanning)g(uses)g(Half)g
(Scanning)g(and)g(hides)g(the)105 257 y(attack)o(er')-5
b(s)27 b(IP)h(address.)39 b(Reserv)o(ed)28 b(\003ag)f(bits)g(may)105
378 y(be)f(set)f(in)h(the)f(TCP)i(header)f(to)f(bypass)g(some)g(port)
105 498 y(scan)g(detectors.)-90 708 y(All)i(these)g(appear)g(to)g(the)g
(attack)o(ed)h(host)e(as)h(one)g(of)h(the)-90 829 y(scanning)c
(techniques)g(mentioned)g(before.)8 951 y(The)34 b(reporting)f
(procedure)i(\()p Ff(esp)p 1248 951 30 4 v 36 w(portscan\(\))p
Fl(\))-90 1071 y(logs)55 b(all)g(reported)g(pack)o(ets)h(into)e(a)i
(data)g(structure)-90 1191 y(where)c(port)f(scans)h(are)g(accumulated,)
58 b(inde)o(x)o(ed)50 b(by)-90 1312 y(source)43 b(address,)48
b(to)42 b(support)g(detection)h(of)g(simulta-)-90 1432
y(neous)32 b(port)h(scans)g(from)g(multiple)e(sources.)55
b(It)33 b(k)o(eeps)-90 1553 y(a)i(table)g(of)g(all)g(IP)h(addresses)f
(that)f(recently)h(sent)g(port)-90 1673 y(scans.)49 b(A)31
b(chained)g(hash)f(table)h(is)f(used)h(to)f(access)i(the)-90
1793 y(table)43 b(\002eld.)88 b(The)43 b(length)g(of)h(the)f(chain)g
(is)h(\002x)o(ed)f(to)-90 1914 y(limit)26 b(the)h(processing)g(o)o(v)o
(erhead.)39 b(This)27 b(technique)g(has)-90 2034 y(been)h(used)f(also)g
(in)g Fc(scanlogd)h Fl([13].)39 b(Furthermore,)28 b(all)-90
2154 y(attack)o(ers)38 b(are)h(also)f(entered)h(at)f(the)g(tail)g(of)g
(a)h(doubly)-90 2275 y(link)o(ed)34 b(list)f(sorted)i(by)f(recent)h
(access.)61 b(This)34 b(may)g(re-)-90 2395 y(quire)25
b(setting)e(\002)n(v)o(e)i(list)e(pointers.)8 2517 y(The)40
b(alarming)g(procedure)i(runs)e(e)n(v)o(ery)g(three)h(sec-)-90
2637 y(onds)24 b(and)g(processes)g(the)g(sorted)g(link)o(ed)g(list)f
(of)h(attack-)-90 2758 y(ers)i(for)f(entries)h(be)o(yond)e(a)i
(threshold)e(\(ten)h(seconds\),)h(if)-90 2878 y(there)19
b(are)h(an)o(y)-6 b(.)28 b(It)18 b(then)h(sends)f(an)h(alarm)g(about)g
(the)f(tech-)-90 2999 y(niques)31 b(used,)h(the)g(attack)o(er')-5
b(s)31 b(IP)h(address)f(and)h(a)f(sum-)-90 3119 y(mary)c(of)g(the)g
(ports)f(probed.)37 b(T)-8 b(o)27 b(distinguish)d(full)j(TCP)-90
3239 y(scans)22 b(from)h(the)f(NetBSD)h(Race)h(attack,)f(multiple)d
(con-)-90 3360 y(nects)i(to)g(the)g(same)g(port,)g(are)h(reported)f(as)
g(race)h(attacks,)-90 3480 y(while)e(a)g(single)f(probe)h(or)g
(multiple)f(probes)g(to)h(dif)n(ferent)-90 3600 y(ports,)j(are)i
(reported)e(as)h(a)g(port)g(scan.)8 3722 y(The)30 b(adv)n(antages)f(of)
i(this)e(type)h(of)h(port)f(scan)g(detec-)-90 3843 y(tion)25
b(are)h(a)g(lo)n(w)e(o)o(v)o(erhead,)h(as)h(not)f(man)o(y)f(pack)o(ets)
i(ha)n(v)o(e)-90 3963 y(to)34 b(be)g(processed)g(by)f(the)h(reporting)f
(routine,)j(and)e(the)-90 4083 y(list)26 b(to)h(check)h(for)f(the)g
(alarming)g(routine)g(is)g(sorted,)g(re-)-90 4204 y(quiring)j(minimal)f
(o)o(v)o(erhead)h(if)h(no)f(alarms)h(are)g(gener)n(-)-90
4324 y(ated.)66 b(It)37 b(also)f(pro)o(vides)g(a)h(high)e(de)o(gree)i
(of)g(accurac)o(y)-90 4445 y(that)j(can)h(reliably)f(detect)g(e)n(v)o
(en)g(a)g(scan)h(for)g(a)f(single)-90 4565 y(port,)35
b(which)f(w)o(as)f(an)h(attack)g(observ)o(ed)f(frequently)g(in)-90
4685 y(the)25 b(test)f(en)l(vironment)g(that)g(is)h(connected)g(to)f
(the)h(Inter)n(-)-90 4806 y(net.)-90 5110 y Fh(3.5)119
b(T)-11 b(esting)29 b(the)i(sensors)-90 5301 y Fl(A)c(test)g(suite)g
(of)g(e)o(xploit)f(programs)g(w)o(as)i(assembled)e(to)-90
5421 y(test)37 b(the)h(sensors.)70 b(The)38 b(e)o(xploit)e(programs)h
(were)i(ac-)1992 137 y(quired)25 b(preferably)i(from)f(the)g(same)g
(sources)g(that)f(pub-)1992 257 y(lished)f(the)g(vulnerabilities,)f(if)
i(the)o(y)f(made)h(them)g(a)n(v)n(ail-)1992 378 y(able.)30
b(Those)25 b(e)o(xploits)e(supposedly)g(w)o(ork)i(against)f(vul-)1992
498 y(nerable)42 b(systems.)81 b(The)o(y)42 b(also)g(pro)o(vide)f(more)
h(tech-)1992 618 y(nical)j(details)g(than)g(some)g(descriptions.)92
b(Ho)n(we)n(v)o(er)l(,)1992 739 y(for)34 b(the)g(follo)n(wing)f
(attacks)h(e)o(xploits)f(were)i(not)f(a)n(v)n(ail-)1992
859 y(able:)c(TCP)c(RST)f(DoS,)g(TCP)h(Sequence)g(Number)e(Pre-)1992
980 y(diction,)j(ICMP)h(Unreachable)g(and)g(Redirect)g(Attacks,)1992
1100 y(NetBSD)33 b(Race)h(and)f(Linux)f(Blind)h(Spoof.)55
b(F)o(or)33 b(these)1992 1220 y(attacks,)40 b(we)e(wrote)g(our)f(o)n
(wn)g(e)o(xploits)f(according)h(to)1992 1341 y(the)27
b(descriptions.)36 b(Some)28 b(publicly)d(a)n(v)n(ailable)i(e)o
(xploits)1992 1461 y(w)o(ork)o(ed)40 b(incorrectly)-6
b(,)43 b(e.g.)77 b(Land,)44 b(due)c(to)g(an)g(incor)n(-)1992
1581 y(rect)48 b(TCP)h(header)f(checksum,)54 b(man)o(y)47
b(T)-7 b(eardrop)48 b(at-)1992 1702 y(tacks,)53 b(due)48
b(to)g(ordering)g(errors,)54 b(and)48 b(some)g(Smurf)1992
1822 y(attacks,)42 b(due)c(to)h(an)g(incorrect)g(sock)o(et)f(for)h
(broadcast)1992 1943 y(pack)o(ets.)59 b(If)35 b(no)f(w)o(orking)g
(substitute)e(w)o(as)j(found,)h(we)1992 2063 y(wrote)30
b(our)h(o)n(wn)f(e)o(xploits.)48 b(F)o(or)31 b(port)f(scanning)g
Fc(nmap)1992 2183 y Fl(w)o(as)d(used.)39 b(A)27 b(successful)g(Fraggle)
h(detection)f(w)o(as)h(not)1992 2304 y(possible)42 b(due)j(to)f(its)f
(inherent)h(dif)n(\002culties,)k(and)c(the)1992 2424
y(Echo-Char)n(gen)20 b(sensor)g(does)g(not)g(report)g(correctly)-6
b(,)21 b(be-)1992 2544 y(cause)28 b(of)g(I/O)g(redirection)f(in)h
Fc(inetd)g Fl(\(this)g(will)f(be)h(cor)n(-)1992 2665
y(rected)22 b(once)h(we)g(start)f(using)f(a)i(sensor)n(-speci\002c)g
(report-)1992 2785 y(ing)e(mechanism\).)29 b(The)23 b(test)f(suite)f(w)
o(as)i(run)f(supervised)1992 2906 y(from)g(a)h(remote)g(machine)f(on)h
(the)f(same)h(local)f(area)i(net-)1992 3026 y(w)o(ork)d(\(LAN\))i(and)f
(all)g(attacks)f(were)i(detected)f(reliably)-6 b(.)2089
3321 y(An)40 b(independent)g(tester)g(ran)h(the)f(same)g(set)g(of)h
(at-)1992 3441 y(tacks.)78 b(First)41 b(the)g(attacks)g(were)g(run)g(o)
o(v)o(er)f(the)h(cam-)1992 3561 y(pus)31 b(netw)o(ork,)j(with)d(dif)n
(ferent)h(netw)o(ork)f(technologies)1992 3682 y(and)40
b(possibly)f(e)n(v)o(en)h(\002ltering)g(in)g(between.)79
b(The)40 b(re-)1992 3802 y(sults)20 b(were)i(that)g(only)e(a)i(v)o(ery)
g(small)e(number)i(of)f(attacks)1992 3922 y(arri)n(v)o(ed)34
b(at)h(the)g(tar)n(get.)62 b(This)34 b(e)o(xperience)i(sho)n(ws)e(that)
1992 4043 y(most)28 b(attacks)i(are)g(of)g(rather)g(lo)n(w)f(quality)g
(\(as)h(also)f(the)1992 4163 y(e)o(xperiences)23 b(abo)o(v)o(e)g
(indicate\))h(and)f(are)i(v)o(ery)f(fragile)f(to)1992
4284 y(the)35 b(netw)o(ork)f(en)l(vironment.)61 b(The)35
b(pack)o(et)h(log)e(sho)n(ws)1992 4404 y(that)j(all)g(recei)n(v)o(ed)g
(attacks)h(were)g(detected.)69 b(The)38 b(test)1992 4524
y(w)o(as)f(repeated)h(from)f(a)h(machine)f(on)h(the)f(same)g(LAN)1992
4645 y(and)24 b(the)h(results)f(match)g(those)h(of)f(the)h(supervised)f
(test.)2089 4939 y(In)30 b(the)g(testing)f(period)g(the)h(host)f
(reported)h(some)g(at-)1992 5060 y(tacks)20 b(not)f(generated)i(as)f(a)
h(controlled)e(e)o(xperiment,)h(no-)1992 5180 y(tably)32
b(port)h(scans.)57 b(T)-8 b(o)33 b(v)o(erify)g(their)g(correctness)h
(the)o(y)1992 5301 y(were)c(compared)f(to)h(the)f(pack)o(et)h(log)f
(and)h(all)f(could)g(be)1992 5421 y(v)o(eri\002ed)24
b(as)h(real)g(attacks.)1900 5670 y(12)p eop
%%Page: 13 13
13 12 bop -90 137 a Fm(4)143 b(Conclusions)33 b(and)j(futur)m(e)e(w)o
(ork)-90 362 y Fl(W)-8 b(e)35 b(ha)n(v)o(e)g(sho)n(wn)e(an)i
(application)f(of)g(the)h(use)g(of)g(em-)-90 482 y(bedded)h(sensors)f
(for)h(intrusion)f(detection,)j(in)d(partic-)-90 603
y(ular)g(to)g(the)f(detection)h(of)g(common)e(netw)o(ork)i(attacks)-90
723 y(and)25 b(port)f(scans.)8 844 y(The)f(e)o(xcellent)f(detection)g
(rate)i(is)e(v)o(ery)h(encouraging)-90 965 y(and)f(sho)n(ws)e(that)h
(this)g(approach)h(to)f(intrusion)f(detection)-90 1085
y(is)33 b(v)o(ery)f(promising.)54 b(The)33 b(simplicity)d(of)j(most)f
(detec-)-90 1205 y(tors)22 b(suggests)f(that)h(the)g(impact)f(on)h(the)
h(host)e(is)h(lo)n(w)-6 b(,)21 b(b)n(ut)-90 1326 y(it)27
b(should)g(be)h(v)o(eri\002ed)f(with)g(benchmarks.)39
b(W)-8 b(e)28 b(imple-)-90 1446 y(mented)21 b(sensors)h(for)g(15)f(dif)
n(ferent)h(netw)o(ork)f(attacks)h(by)-90 1566 y(adding)i(only)g(73)h
(lines)f(of)h(code)g(to)g(the)g(OpenBSD)g(k)o(er)n(-)-90
1687 y(nel,)d(25)f(lines)g(to)g(the)g Fc(inetd)i Fl(program,)e(and)h
(tw)o(o)f(support)-90 1807 y(\002les)g(with)f(a)i(total)e(of)h(354)f
(lines)h(of)g(code.)29 b(Most)20 b(sensors)-90 1928 y(are)30
b(no)f(longer)h(than)f(4)g(lines)g(of)g(code,)i(and)f(some)f(sen-)-90
2048 y(sors)35 b(are)i(for)f(platforms)f(other)g(than)g(OpenBSD)i
(\(lik)o(e)-90 2168 y(W)l(inNuk)o(e,)49 b(which)44 b(is)g(a)h(W)l(indo)
n(ws-speci\002c)f(attack\),)-90 2289 y(which)30 b(sho)n(ws)f(that)h(a)h
(single)e(host)h(instrumented)e(with)-90 2409 y(internal)d(sensors)h
(can)g(detect)g(attacks)g(for)g(dif)n(ferent)g(ar)n(-)-90
2530 y(chitectures)e(and)h(operating)f(systems.)8 2651
y(The)j(sensors)f(ha)n(v)o(e)h(been)g(the)g(simplest)e(in)h(the)h
(cases)-90 2771 y(where)35 b(the)g(k)o(ernel)g(itself)f(already)h
(checks)g(for)g(the)f(at-)-90 2891 y(tacks.)29 b(This)19
b(has)g(been)h(mostly)e(the)h(case)h(for)g(recent)g(vul-)-90
3012 y(nerabilities)30 b(that)h(depend)g(on)g(implementation)e(\003a)o
(ws:)-90 3132 y(Land,)46 b(T)-7 b(eardrop,)46 b(TCP)c(RST)h(DoS)f(and)f
(ICMP)i(Un-)-90 3253 y(reachable)33 b(DoS.)g(Some)g(sensors)f(required)
h(additional)-90 3373 y(checks)24 b(at)g(speci\002c)g(places)g(to)g
(raise)g(an)g(alarm:)30 b(Ping)24 b(of)-90 3493 y(Death,)h(NetBSD)g
(race)h(and)f(Linux)f(Blind)g(Spoof.)8 3614 y(There)h(are)i(attacks)e
(that)g(are)h(based)f(in)h(the)f(design)g(of)-90 3735
y(the)36 b(protocols:)53 b(SYN)37 b(\003ood,)j(Port)d(Scanning,)i(ICMP)
-90 3855 y(redirects)31 b(and)g(ICMP)h(unreachable.)51
b(ICMP)31 b(redirects)-90 3976 y(and)d(ICMP)g(unreachable)g(attacks)g
(are)g(undetectable)g(if)-90 4096 y(the)o(y)43 b(are)h(done)f(cle)n(v)o
(erly)-6 b(.)85 b(Port)43 b(Scanning)h(is)f(unde-)-90
4216 y(tectable)26 b(if)g(no)g(connections)f(attempts)g(to)h(closed)f
(ports)-90 4337 y(are)32 b(made,)g(which)f(contradicts)f(its)h
(intention)e(of)i(gath-)-90 4457 y(ering)22 b(information)f(about)h
(the)h(tar)n(get.)30 b(SYN)23 b(\003oods)f(are)-90 4577
y(pre)n(v)o(ented)28 b(in)g(OpenBSD)i(2.6)e(by)h(resource)g(limitation)
-90 4698 y(and)c(acti)n(v)o(e)f(disconnects)f(of)i(pending)f
(connections.)8 4819 y(F)o(or)37 b(the)h(scope)g(of)g(this)f(study)-6
b(,)40 b(mainly)d(the)h(k)o(ernel)-90 4939 y(has)g(been)h(in)l(v)o
(estigated.)69 b(But)38 b(as)h(the)f(W)l(inNuk)o(e)g(and)-90
5060 y(Echo-Char)n(gen)i(cases)f(sho)n(w)-6 b(,)40 b(there)f(are)h
(netw)o(ork)e(at-)-90 5180 y(tacks)d(for)g(which)f(sensors)g(are)i
(better)f(placed)g(outside)-90 5301 y(the)29 b(k)o(ernel.)44
b(Also)29 b(some)f(sensors)h(require)h(more)f(com-)-90
5421 y(putation,)24 b(namely)g(Smurf)i(and)f(Port)g(Scanning.)32
b(If)25 b(rate)1992 137 y(information)35 b(is)i(helpful)f(or)h
(necessary)-6 b(,)40 b(sensors)c(split)1992 257 y(into)i(tw)o(o)h
(parts:)59 b(a)39 b(reporting)g(function)f(that)h(gathers)1992
378 y(data)33 b(and)g(an)g(alarming)g(function)f(that)h(checks)g(for)h
(at-)1992 498 y(tack)24 b(thresholds)g(and)h(raises)f(the)h(alarms.)
2089 645 y(Fraggle)39 b(attacks)g(require)g(additional)e(w)o(ork.)72
b(Sen-)1992 766 y(sors)40 b(in)h(a)g(set)g(of)g(possibly)f(vulnerable)h
(applications)1992 886 y(combined)56 b(with)g(a)i(rate)f(limitation)e
(should)h(detect)1992 1006 y(them.)36 b(In)27 b(future)g(w)o(ork)f
(sensors)h(could)f(be)h(placed)g(into)1992 1127 y(all)35
b(states)g(of)h(TCP)-11 b(,)36 b(not)f(only)g(in)g(the)h(initial)e
(states)h(of)1992 1247 y(a)h(connection,)i(reporting)e(all)g(une)o
(xpected)f(\003ag)i(com-)1992 1368 y(binations.)78 b(This)40
b(might)g(be)h(able)g(to)g(detect)g(yet)g(un-)1992 1488
y(e)o(xploited)47 b(vulnerabilities.)100 b(A)49 b(UDP)g(port)g(scanner)
1992 1608 y(w)o(as)39 b(planned,)44 b(b)n(ut)39 b(not)g(implemented,)j
(and)e(a)g(lar)n(ger)1992 1729 y(list)g(of)i(vulnerabilities)d(should)i
(enhance)h(the)f(results)1992 1849 y(achie)n(v)o(ed.)2089
1996 y(The)22 b(reporting)f(mechanism)g(used)g(in)g(this)g(study)g(w)o
(as)1992 2117 y(the)39 b(one)g(already)h(a)n(v)n(ailable)e(in)h(the)h
(system.)73 b(As)39 b(the)1992 2237 y(Echo-Char)n(gen)47
b(sensor)f(sho)n(ws,)51 b(this)46 b(is)g(not)g(al)o(w)o(ays)1992
2358 y(con)l(v)o(enient,)27 b(and)h(special)g(reporting)g(mechanisms)e
(are)1992 2478 y(necessary)-6 b(.)37 b(W)-8 b(e)27 b(are)h(currently)f
(researching)g(the)g(needs)1992 2598 y(and)45 b(problems)f(related)h
(to)g(these)g(reporting)g(mecha-)1992 2719 y(nisms,)33
b(taking)e(into)h(account)g(the)h(speci\002c)g(needs)f(and)1992
2839 y(beha)n(vior)38 b(of)i(the)f(sensors.)73 b(An)40
b(initial)d(implementa-)1992 2959 y(tion)g(has)h(been)g(done,)j(and)e
(the)f(e)o(xisting)e(sensors)h(are)1992 3080 y(being)31
b(modi\002ed)h(to)g(use)g(it.)53 b(One)33 b(of)f(the)g(problems)f(to)
1992 3200 y(be)c(solv)o(ed)e(is)i(that)f(sensors)g(may)h(e)o(xist)e(in)
i(both)f(k)o(ernel-)1992 3321 y(and)37 b(user)n(-space)i(processes.)70
b(T)-8 b(o)38 b(a)n(v)n(oid)f(unnecessary)1992 3441 y(conte)o(xt)26
b(switches,)h(hooks)f(into)h(the)g(reporting)g(mecha-)1992
3561 y(nism)d(should)g(e)o(xist)g(in)h(both)g(spaces.)33
b(Ho)n(we)n(v)o(er)l(,)24 b(all)h(the)1992 3682 y(results)k(need)i(to)g
(be)f(e)n(v)o(entually)f(coalesced)i(for)g(analy-)1992
3802 y(sis.)56 b(W)-8 b(e)34 b(ha)n(v)o(e)f(not)g(determined)g(yet)g
(the)g(best)g(w)o(ay)h(of)1992 3922 y(handling)23 b(this)h(data)h
(\003o)n(w)-6 b(.)2089 4070 y(W)e(ork)22 b(is)g(also)g(underw)o(ay)g
(in)f(the)h(implementation)e(of)1992 4190 y(sensors)35
b(for)h(other)g(types)f(of)h(attacks)g(and)g(intrusions,)1992
4311 y(not)24 b(only)g(netw)o(ork-based.)2089 4458 y(As)j(more)g
(sensors)g(are)h(implemented)d(and)i(more)g(in-)1992
4578 y(formation)35 b(is)h(collected,)k(we)c(e)o(xpect)h(to)f(gain)g
(insight)1992 4699 y(into)26 b(the)g(types)h(of)g(information)e(needed)
j(to)e(detect)h(dif-)1992 4819 y(ferent)36 b(intrusions)d(and)j
(attacks.)63 b(Also,)37 b(if)f(embedded)1992 4939 y(sensors)30
b(sho)n(w)g(to)g(be)h(a)h(viable)e(approach,)j(maybe)d(op-)1992
5060 y(erating)37 b(system)g(v)o(endors)g(will)h(start)f(including)g
(them)1992 5180 y(in)29 b(their)h(distrib)n(utions,)e(allo)n(wing)g
(intrusion)h(detection)1992 5301 y(systems)h(to)h(ha)n(v)o(e)g(access)h
(to)f(much)g(more)h(useful)f(data)1992 5421 y(about)24
b(system)f(beha)n(vior)-5 b(.)1900 5670 y(13)p eop
%%Page: 14 14
14 13 bop -90 137 a Fm(5)143 b(Ackno)o(wledgments)-90
367 y Fl(W)-8 b(e)24 b(w)o(ould)f(lik)o(e)h(to)f(thank)g(Christopher)h
(T)-7 b(elfer)24 b(for)g(per)n(-)-90 487 y(forming)g(the)h
(unsupervised)e(tests.)-90 847 y Fm(6)143 b(A)-7 b(uthor)34
b(biographies)-90 1078 y Fc(Florian)22 b(K)n(erschbaum)h
Fl(is)f(a)h(Ph.D.)f(student)g(at)g(Purdue)-90 1198 y(Uni)n(v)o(ersity)
31 b(where)j(he)g(is)f(w)o(orking)g(for)h(CERIAS.)g(He)-90
1318 y(obtained)27 b(his)g(M.S.)h(in)g(Computer)f(Science)i(from)f(Pur)
n(-)-90 1439 y(due)21 b(Uni)n(v)o(ersity)-6 b(.)27 b(His)20
b(research)j(interests)d(are)i(Intrusion)-90 1559 y(Detection)i(and)h
(Security)g(Algorithms.)8 1683 y Fc(Eugene)46 b(H.)f(Spaff)n(ord)i
Fl(is)d(a)i(professor)f(of)h(Com-)-90 1803 y(puter)41
b(Sciences)h(at)f(Purdue)h(Uni)n(v)o(ersity)-6 b(,)43
b(the)e(uni)n(v)o(er)n(-)-90 1923 y(sity')-5 b(s)38 b(Information)h
(Systems)g(Security)h(Of)n(\002cer)l(,)45 b(and)-90 2044
y(is)34 b(Director)h(of)g(the)g(Center)g(for)g(Education)f(Research)-90
2164 y(Information)49 b(Assurance)i(and)f(Security)-6
b(.)107 b(CERIAS)-90 2285 y(is)35 b(a)g(campus-wide)g
(multi-disciplinary)d(Center)l(,)38 b(with)-90 2405 y(a)46
b(broadly-focused)f(mission)e(to)i(e)o(xplore)g(issues)g(re-)-90
2525 y(lated)21 b(to)g(protecting)f(information)g(and)h(information)f
(re-)-90 2646 y(sources.)41 b(Spaf)29 b(has)f(written)f(e)o(xtensi)n(v)
o(ely)f(about)i(infor)n(-)-90 2766 y(mation)c(security)-6
b(,)23 b(softw)o(are)i(engineering,)g(and)f(profes-)-90
2886 y(sional)32 b(ethics.)56 b(He)33 b(has)g(published)f(o)o(v)o(er)g
(100)h(articles)-90 3007 y(and)41 b(reports)f(on)h(his)f(research,)45
b(has)c(written)f(or)g(con-)-90 3127 y(trib)n(uted)33
b(to)h(o)o(v)o(er)f(a)h(dozen)g(books,)h(and)f(he)g(serv)o(es)g(on)-90
3248 y(the)29 b(editorial)g(boards)g(of)h(most)e(major)i
(infosec-related)-90 3368 y(journals.)8 3492 y(Dr)-5
b(.)64 b(Spaf)n(ford)36 b(is)g(a)g(Fello)n(w)g(of)g(the)g(A)l(CM,)g
(Fello)n(w)-90 3612 y(of)42 b(the)g(AAAS,)h(senior)f(member)f(of)i(the)
f(IEEE,)g(and)-90 3732 y(is)f(a)i(charter)f(recipient)g(of)g(the)g
(Computer)f(Society')-5 b(s)-90 3853 y(Golden)38 b(Core)h(a)o(w)o(ard.)
70 b(Among)38 b(other)g(acti)n(vities,)h(he)-90 3973
y(is)h(chair)h(of)g(the)g(A)l(CM')-5 b(s)40 b(U.S.)h(Public)g(Polic)o
(y)f(Com-)-90 4094 y(mittee,)27 b(a)h(member)e(of)i(the)f(Board)h(of)f
(Directors)g(of)h(the)-90 4214 y(Computing)f(Research)j(Association)d
(,)j(and)f(is)f(a)h(mem-)-90 4334 y(ber)21 b(of)g(the)f(US)h(Air)f(F)o
(orce)i(Scienti\002c)f(Advisory)e(Board.)-90 4455 y(He)24
b(re)o(gularly)g(serv)o(es)g(as)g(a)g(consultant)f(on)h(information)-90
4575 y(security)35 b(and)h(computer)f(crime)h(to)f(la)o(w)h(\002rms,)i
(major)-90 4695 y(corporations,)25 b(U.S.)i(go)o(v)o(ernment)d
(agencies,)i(and)g(state)-90 4816 y(and)f(national)f(la)o(w)h
(enforcement)g(agencies)h(around)f(the)-90 4936 y(w)o(orld.)8
5060 y Fc(Diego)40 b(Zamboni)j Fl(is)d(a)i(Ph.D.)g(student)e(at)h
(Purdue)-90 5180 y(Uni)n(v)o(ersity)-6 b(,)23 b(where)i(he)h(is)f(w)o
(orking)f(in)h(CERIAS)h(in)f(In-)-90 5301 y(trusion)30
b(Detection)h(research.)52 b(He)31 b(obtained)g(his)g(M.S.)-90
5421 y(in)21 b(Computer)f(Science)i(from)f(Purdue)h(Uni)n(v)o(ersity)-6
b(.)27 b(Pre-)1992 137 y(viously)c(he)i(obtained)f(his)g(bachelor')-5
b(s)24 b(de)o(gree)h(in)f(Com-)1992 257 y(puter)i(Engineering)g(from)g
(the)g(National)g(Autonomous)1992 378 y(Uni)n(v)o(ersity)j(of)j(Me)o
(xico,)g(where)g(he)g(w)o(as)f(in)h(char)n(ge)g(of)1992
498 y(the)k(security)f(for)i(the)f(Unix)f(machines)h(at)g(the)g(Super)n
(-)1992 618 y(computing)i(Department.)75 b(He)40 b(also)g(established)e
(the)1992 739 y(Uni)n(v)o(ersity')-5 b(s)32 b(Computer)k(Security)g
(Area,)j(one)c(of)h(the)1992 859 y(\002rst)29 b(Computer)f(Security)i
(Incident)e(Response)h(T)-7 b(eams)1992 980 y(in)24 b(Me)o(xico.)2089
1100 y(More)88 b(information)e(about)i(the)f(authors)h(can)1992
1220 y(be)35 b(found)f(at)i Ff(http://www.cerias.purdue.)1992
1341 y(edu/personnel.php3)p Fl(.)1992 1677 y Fm(Refer)m(ences)2041
1901 y Fl([1])49 b(Aleph)25 b(One.)35 b(Smashing)24 b(the)h(stack)g
(for)g(fun)f(and)2206 2021 y(pro\002t.)36 b Fg(Phr)o(ac)n(k)24
b(Ma)o(gazine)p Fl(,)g(7\(49\):File)g(14,)2206 2142 y(1996.)35
b(Appeared)25 b(also)g(on)f(Bugtraq)2206 2262 y(\()p
Ff(http://www.securityfocus.com/)2206 2383 y(archive/1/5667)p
Fl(\).)2041 2581 y([2])49 b(Jai)25 b(Sundar)g(Balasubramaniyan,)f(Jose)
h(Omar)2206 2701 y(Garcia-Fernandez,)i(Da)n(vid)d(Isacof)n(f,)h(Eugene)
2206 2822 y(Spaf)n(ford,)g(and)g(Die)o(go)f(Zamboni.)34
b(An)2206 2942 y(architecture)25 b(for)g(intrusion)f(detection)g(using)
2206 3062 y(autonomous)f(agents.)36 b(In)24 b Fg(Pr)l(oceedings)g(of)g
(the)2206 3183 y(F)-10 b(ourteenth)23 b(Annual)h(Computer)h(Security)
2206 3303 y(Applications)e(Confer)l(ence)p Fl(,)i(pages)g(13\22624.)
2206 3424 y(IEEE)g(Computer)f(Society)-6 b(,)25 b(December)g(1998.)2041
3622 y([3])49 b(Bruce)26 b(Barnett)f(and)g(Dai)g(N.)g(V)-7
b(u.)35 b(V)-7 b(ulnerability)2206 3742 y(assessment)24
b(and)h(intrusion)e(detection)h(with)2206 3863 y(dynamic)g(softw)o(are)
h(agents.)36 b(In)24 b Fg(Pr)l(oceedings)g(of)2206 3983
y(the)h(Softwar)l(e)f(T)-9 b(ec)o(hnolo)o(gy)25 b(Confer)l(ence)p
Fl(,)g(April)2206 4103 y(1997.)2041 4302 y([4])49 b(S.M.)25
b(Bello)o(vin.)34 b(Security)25 b(problems)f(in)h(the)2206
4422 y(TCP/IP)h(protocol)e(suite.)35 b Fg(Computer)2206
4543 y(Communication)24 b(Re)o(vie)o(w)p Fl(,)g(19\(2\):32\22648,)g
(April)2206 4663 y(1989.)2041 4861 y([5])49 b(BugT)m(raq.)36
b(Mailing)23 b(list)h(archi)n(v)o(e.)35 b(W)-8 b(eb)25
b(page)g(at)2206 4982 y Ff(http://www.securityfocus.com/)p
Fl(,)2206 5102 y(1999\2262000.)2041 5301 y([6])49 b(CER)-6
b(T)26 b(Coordination)e(Center.)36 b(CER)-6 b(T/CC)2206
5421 y(statistics.)34 b(W)-8 b(eb)25 b(page)g(at)1900
5670 y(14)p eop
%%Page: 15 15
15 14 bop 125 137 a Ff(http://www.cert.org/stats/)125
257 y(cert_stats.html)p Fl(,)21 b(1999.)-40 496 y([7])49
b(Ste)n(v)o(en)24 b(Christe)o(y)-6 b(,)23 b(Mann,)i(and)f(Hill.)125
617 y(De)n(v)o(elopment)e(of)j(a)g(common)f(vulnerability)125
737 y(enumeration.)35 b(W)-8 b(orkshop)24 b(RAID99,)125
857 y(September)h(1999.)-40 1096 y([8])49 b(Cisco)24
b(Systems.)33 b(Cisco)24 b(secure)h(IDS.)34 b(W)-8 b(eb)24
b(page)125 1217 y(at)h Ff(http://www.wheelgroup.com/)125
1337 y(univercd/cc/td/doc/pcat/nerg)o(.)125 1457 y(htm)p
Fl(,)f(January)h(2001.)-40 1696 y([9])49 b(Douglas)24
b(Comer)h(and)g(Da)n(vid)f(Ste)n(v)o(ens.)125 1817 y
Fg(Internetworking)g(with)g(TCP/IP:)i(Principles,)125
1937 y(Pr)l(otocols)d(and)h(Ar)l(c)o(hitectur)l(e)p Fl(.)35
b(Prentice-Hall,)125 2057 y(Engle)n(w)o(ood)23 b(Clif)n(fs,)h(NJ)h
(07632,)f(USA,)h(1991.)125 2178 y(ISBN)h(0-13-468505-9.)-90
2417 y([10])49 b(Mark)24 b(Crosbie,)h(Bryn)g(Dole,)g(T)-8
b(odd)24 b(Ellis,)g(Iv)n(an)125 2537 y(Krsul,)g(and)h(Eugene)f(Spaf)n
(ford.)36 b(IDIO)l(T\227users)125 2658 y(guide.)f(CSD-TR)26
b(96-050,)e(CO)m(AST)125 2778 y(Laboratory)-6 b(,)24
b(Purdue)h(Uni)n(v)o(ersity)-6 b(,)22 b(1398)125 2898
y(Computer)i(Science)i(Building,)d(W)-8 b(est)25 b(Laf)o(ayette,)125
3019 y(IN)g(47907-1398,)e(September)i(1996.)35 b(URL)125
3139 y Ff(http://www.cerias.purdue.edu)o(/)125 3259 y
(techreports/public/96-)t(04.ps)p Fl(.)-90 3498 y([11])49
b(Dan)25 b(F)o(armer)g(and)g(W)l(ietse)f(V)-11 b(enema.)36
b(Computer)125 3619 y(forensics)24 b(analysis)g(class)h(handouts.)34
b(W)-8 b(eb)25 b(page)125 3739 y(at)g Ff(http:)125 3860
y(//www.fish.com/forensics/)p Fl(,)125 3980 y(August)e(1999.)35
b(Accessed)26 b(in)e(May)h(2000.)-90 4219 y([12])49 b(FreeBSD)26
b(Security)f(Of)n(\002cer.)37 b(TCP)25 b(RST)h(denial)125
4339 y(of)f(se)n(vice.)35 b(FreeBSD)27 b(Security)e(Advisory)125
4460 y(SA-98:07,)f(FreeBSD,)j(Inc.,)e(October)f(1998.)125
4580 y(URL)h Ff(ftp://ftp.FreeBSD.org/pub/)125 4700 y
(FreeBSD/CERT/advisories/)125 4821 y(FreeBSD-)t(SA-)t(98:07.rst.asc)p
Fl(.)-90 5060 y([13])49 b(Fyodor)24 b(\(fyodor@dhp.com\).)35
b(The)25 b(art)g(of)g(port)125 5180 y(scanning.)35 b(Internet)125
5301 y Ff(http://www.insecure.org/nmap)o(/)125 5421 y(nmap_doc.html)p
Fl(,)22 b(September)j(1997.)1992 137 y([14])48 b(R.)26
b(Heady)-6 b(,)24 b(G.)h(Luger)l(,)f(A.)h(Maccabe,)g(and)2206
257 y(M.)g(Servilla.)35 b(The)25 b(Architecture)g(of)g(a)g(Netw)o(ork)
2206 378 y(Le)n(v)o(el)f(Intrusion)f(Detection)h(System.)35
b(T)-7 b(echnical)2206 498 y(report,)25 b(Uni)n(v)o(ersity)e(of)h(Ne)n
(w)h(Me)o(xico,)2206 618 y(Department)g(of)f(Computer)h(Science,)g
(August)2206 739 y(1990.)1992 957 y([15])48 b(L.)25 b(Heberlein,)g(G.)f
(Dias,)h(K.)f(Le)n(vitt,)2206 1078 y(B.)i(Mukherjee,)e(J.)g(W)-8
b(ood,)25 b(and)g(D.)f(W)-8 b(olber)j(.)35 b(A)2206 1198
y(Netw)o(ork)25 b(Security)g(Monitor.)34 b(In)25 b Fg(Pr)l(oceedings)
2206 1318 y(of)g(the)f(IEEE)h(Symposium)f(on)g(Resear)l(c)o(h)h(in)2206
1439 y(Security)g(and)f(Privacy)p Fl(,)h(May)f(1990.)1992
1657 y([16])48 b(Gene)25 b(H.)g(Kim)f(and)h(Eugene)g(H.)f(Spaf)n(ford.)
36 b(The)2206 1778 y(design)24 b(and)h(implementation)d(of)j(T)m
(ripwire:)30 b(A)2206 1898 y(\002le)25 b(system)f(inte)o(grity)f(check)
o(er)-5 b(.)36 b(In)25 b Fg(Pr)l(oceedings)2206 2019
y(of)g(the)f(2nd)h(A)m(CM)g(Confer)l(ence)g(on)g(Computer)2206
2139 y(and)g(Communications)e(Security)p Fl(,)h(pages)h(18\22629,)2206
2259 y(F)o(airf)o(ax,)g(V)-6 b(ir)n(ginia,)24 b(No)o(v)o(ember)g(1994.)
g(A)l(CM)2206 2380 y(Press.)1992 2598 y([17])48 b(T)-7
b(.)25 b(F)-8 b(.)25 b(Lunt,)f(A.)h(T)-8 b(amaru,)24
b(F)-8 b(.)25 b(Gilham,)2206 2719 y(R.)h(Jagannathan,)d(P)-11
b(.)25 b(G.)g(Neumann,)f(H.)h(S.)2206 2839 y(Ja)n(vitz,)g(A.)f(V)-11
b(aldes,)25 b(and)f(T)-7 b(.)25 b(D.)f(Garv)o(e)o(y)-6
b(.)35 b(A)2206 2959 y(Real-T)m(ime)25 b(Intrusion)e(Detection)i
(Expert)2206 3080 y(System)g(\(IDES\))g(\226)g(Final)g(T)-7
b(echnical)24 b(Report.)2206 3200 y(T)-7 b(echnical)25
b(report,)g(SRI)h(Computer)e(Science)2206 3321 y(Laboratory)-6
b(,)24 b(SRI)i(International,)e(Menlo)g(P)o(ark,)2206
3441 y(CA,)h(February)h(1992.)1992 3660 y([18])48 b(Marshall)24
b(Kirk)h(McK)o(usick,)e(K)n(eith)h(Bostic,)2206 3780
y(Michael)h(J.)f(Karels,)h(and)g(John)f(S.)h(Quarterman.)2206
3900 y Fg(The)h(Design)e(and)g(Implementation)f(of)i(the)2206
4021 y(4.4BSD)f(Oper)o(ating)f(System)p Fl(.)36 b(Addison-W)-8
b(esle)o(y)i(,)2206 4141 y(Reading,)25 b(MA,)f(USA,)i(1996.)35
b(ISBN)2206 4261 y(0-201-54979-4.)1992 4480 y([19])48
b(Merriam-W)-8 b(ebster)j(.)35 b(\223intrusion\224.)2206
4600 y(Merriam-W)-8 b(ebster)25 b(OnLine:)30 b(WWW)-8
b(ebster)2206 4721 y(Dictionary.)2206 4841 y Ff(http://www.m-)t
(w.com/dictionary)p Fl(,)2206 4962 y(1998.)35 b(Accessed)25
b(on)g(May)f(16,)h(1998.)1992 5180 y([20])48 b(MITRE.)36
b(Common)24 b(vulnerabilities)f(and)2206 5301 y(e)o(xposures.)35
b(W)-8 b(eb)25 b(page)g(at)2206 5421 y Ff(http://cve.mitre.org)p
Fl(,)c(1999\2262000.)1900 5670 y(15)p eop
%%Page: 16 16
16 15 bop -90 137 a Fl([21])49 b(Bisw)o(anath)24 b(Mukherjee,)h(T)-8
b(odd)24 b(L.)h(Heberlein,)125 257 y(and)g(Karl)f(N.)h(Le)n(vitt.)34
b(Netw)o(ork)25 b(intrusion)125 378 y(detection.)35 b
Fg(IEEE)24 b(Network)p Fl(,)i(8\(3\):26\22641,)125 498
y(May/June)e(1994.)-90 692 y([22])49 b(NetBSD)25 b(Security)g(Of)n
(\002cer.)125 812 y(select\(2\)/accept\(2\))g(race)h(condition)d(in)h
(TCP)125 933 y(serv)o(ers.)35 b(NetBSD)26 b(Security)f(Advisory)125
1053 y(1999-01,)f(The)g(NetBSD)i(F)o(oundation,)d(1999.)125
1174 y(URL)i Ff(ftp:)125 1294 y(//ftp.NetBSD.ORG/pub/NetBSD/)125
1414 y(misc/security/advisories/)125 1535 y(NetBSD-)t(SA1999-)t
(001.txt.asc)p Fl(.)-90 1729 y([23])49 b(Netw)o(ork)24
b(Associates,)g(Inc.)36 b(Linux)24 b(blind)g(TCP)125
1849 y(spoo\002ng.)35 b(CIA)l(C)26 b(Bulletin)e(J-035,)g(Computer)125
1969 y(Incident)g(Advisory)g(Capability)-6 b(,)23 b(March)i(1999.)125
2090 y(URL)g Ff(http://www.ciac.org/ciac/)125 2210 y(bulletins/j-)t
(035.shtml)p Fl(.)-90 2404 y([24])49 b(OpenBSD.)36 b(W)-8
b(eb)25 b(page)g(at)125 2525 y Ff(http://www.openbsd.org/)p
Fl(,)125 2645 y(1999\2262000.)-90 2839 y([25])49 b(P)o(ack)o(et)25
b(Storm.)35 b(W)-8 b(eb)25 b(page)g(at)g Ff(http:)125
2959 y(//packetstorm.securify.com)p Fl(,)125 3080 y(2000.)-90
3274 y([26])49 b(Phillip)23 b(A.)i(Porras)h(and)e(Peter)i(G.)f
(Neumann.)125 3394 y(EMERALD:)f(Ev)o(ent)g(monitoring)e(enabling)125
3515 y(responses)i(to)g(anomalous)g(li)n(v)o(e)f(disturbances.)35
b(In)125 3635 y Fg(Pr)l(oceedings)23 b(of)i(the)f(20th)g(National)125
3755 y(Information)f(Systems)h(Security)g(Confer)l(ence)p
Fl(,)125 3876 y(pages)g(353\226365.)g(National)g(Institute)f(of)125
3996 y(Standards)i(and)f(T)-7 b(echnology)h(,)24 b(1997.)-90
4190 y([27])49 b(Richard)25 b(Po)n(wer)-5 b(.)35 b(1999)25
b(CSI/FBI)h(computer)125 4311 y(crime)e(and)h(security)g(surv)o(e)o(y)
-6 b(.)33 b Fg(Computer)125 4431 y(Security)24 b(J)n(ournal)p
Fl(,)f(V)-13 b(olume)24 b(XV\(2\),)h(1999.)-90 4625 y([28])49
b(Thomas)24 b(H.)g(Ptacek)i(and)f(T)m(imothy)d(N.)125
4745 y(Ne)n(wsham.)34 b(Insertion,)24 b(e)n(v)n(asion,)g(and)g(denial)h
(of)125 4866 y(service:)30 b(Eluding)24 b(netw)o(ork)g(intrusion)125
4986 y(detection.)35 b(T)-7 b(echnical)24 b(report,)h(Secure)125
5107 y(Netw)o(orks,)f(Inc.,)h(January)g(1998.)-90 5301
y([29])49 b(RootShell.)35 b(W)-8 b(eb)25 b(page)g(at)125
5421 y Ff(http://www.rootshell.com)p Fl(,)19 b(2000.)1992
137 y([30])48 b(Samba.)36 b(W)-8 b(eb)25 b(pages)g(at)2206
257 y Ff(http://www.samba.org)p Fl(,)c(2000.)1992 461
y([31])48 b(Christoph)24 b(L.)h(Schuba,)g(Iv)n(an)f(V)-13
b(.)25 b(Krsul,)2206 581 y(Markus)g(G.)f(K)o(uhn,)g(Eugene)h(H.)f(Spaf)
n(ford,)2206 701 y(Aurobindo)g(Sundaram,)h(and)f(Die)o(go)g(Zamboni.)
2206 822 y(Analysis)g(of)h(a)g(denial)f(of)h(service)g(attack)g(on)2206
942 y(TCP.)37 b(In)25 b Fg(Pr)l(oceedings)e(of)i(the)f(1997)g(IEEE)2206
1063 y(Symposium)g(on)g(Security)h(and)f(Privacy)p Fl(,)h(pages)2206
1183 y(208\226223.)f(IEEE)g(Computer)h(Society)-6 b(,)24
b(IEEE)2206 1303 y(Computer)h(Society)f(Press,)i(May)e(1997.)1992
1507 y([32])48 b(SecurityF)o(ocus.)36 b(W)-8 b(eb)25
b(page)g(at)2206 1627 y Ff(http://www.securityfocus.com/)p
Fl(,)2206 1747 y(1999\2262000.)1992 1951 y([33])48 b(Eugene)25
b(Spaf)n(ford)g(and)g(Die)o(go)f(Zamboni.)34 b(Data)2206
2071 y(collection)24 b(mechanisms)g(for)h(intrusion)2206
2192 y(detection)f(systems.)35 b(CERIAS)26 b(T)-7 b(echnical)2206
2312 y(Report)25 b(2000-08,)f(CERIAS,)i(Purdue)2206 2432
y(Uni)n(v)o(ersity)-6 b(,)22 b(1315)i(Recitation)h(Building,)e(W)-8
b(est)2206 2553 y(Laf)o(ayette,)25 b(IN,)g(June)g(2000.)1992
2756 y([34])48 b(Eugene)25 b(H.)g(Spaf)n(ford)g(and)f(Die)o(go)g
(Zamboni.)2206 2877 y(Intrusion)g(detection)g(using)g(autonomous)2206
2997 y(agents.)36 b Fg(Computer)24 b(Networks)p Fl(,)h
(34\(4\):547\226570,)2206 3117 y(October)g(2000.)1992
3321 y([35])48 b(W)-9 b(.)25 b(Richard)g(Ste)n(v)o(ens.)35
b Fg(TCP/IP)25 b(Illustr)o(ated)p Fl(,)2206 3441 y(v)n(olume)f(V)-13
b(olume)24 b(2\227The)g(Implementation)f(of)2206 3561
y Fg(Pr)l(ofessional)f(Computing)i(Series)p Fl(.)2206
3682 y(Addison-W)-8 b(esle)o(y)i(,)23 b(1994.)1992 3885
y([36])48 b(K)n(ymie)24 b(M.)g(C.)i(T)-8 b(an,)24 b(Da)n(vid)h
(Thompson,)e(and)2206 4006 y(A.)i(B.)g(Ruigha)n(v)o(er)-5
b(.)35 b(Intrusion)24 b(detection)2206 4126 y(systems)g(and)g(a)i(vie)n
(w)e(to)g(its)g(forensic)2206 4246 y(applications.)35
b(T)-7 b(echnical)24 b(report,)h(Department)2206 4367
y(of)g(Computer)g(Science,)g(Uni)n(v)o(ersity)e(of)2206
4487 y(Melbourne,)h(P)o(arkville)g(3052,)g(Australia,)g(year)2206
4608 y(of)h(publication)e(unk)o(o)n(wn.)35 b(URL)2206
4728 y Ff(http://www.securityfocus.com/)2206 4848 y
(data/library/idsforensics.ps)p Fl(.)1992 5052 y([37])48
b(X-F)o(orce.)36 b(W)-8 b(eb)26 b(page)f(at)2206 5172
y Ff(http://xforce.iss.net)p Fl(,)20 b(2000.)1900 5670
y(16)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
SafetyEnclosure restore
%%EOF
